<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="openxlsx2">
<title>openxlsx2 style manual â€¢ openxlsx2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="openxlsx2 style manual">
<meta property="og:description" content="openxlsx2">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openxlsx2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/openxlsx2.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Update-from-openxlsx.html">Upgrade from openxlsx</a>
    <a class="dropdown-item" href="../articles/conditional-formatting.html">Conditional Formatting</a>
    <a class="dropdown-item" href="../articles/openxlsx2_charts_manual.html">openxlsx2 charts manual</a>
    <a class="dropdown-item" href="../articles/openxlsx2_formulas_manual.html">openxlsx2 formulas manual</a>
    <a class="dropdown-item" href="../articles/openxlsx2_style_manual.html">openxlsx2 style manual</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JanMarvin/openxlsx2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>openxlsx2 style manual</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JanMarvin/openxlsx2/blob/HEAD/vignettes/openxlsx2_style_manual.Rmd" class="external-link"><code>vignettes/openxlsx2_style_manual.Rmd</code></a></small>
      <div class="d-none name"><code>openxlsx2_style_manual.Rmd</code></div>
    </div>

    
    
<p>Welcome to the styling manual for <code>openxlsx2</code>. In this
manual you will learn how to use <code>openxlsx2</code> to style your
worksheets. data from xlsx-files to R as well as how to export data from
R to xlsx, and how to import and modify these openxml workbooks in
R.</p>
<div class="section level2">
<h2 id="styling-showcase">Styling showcase<a class="anchor" aria-label="anchor" href="#styling-showcase"></a>
</h2>
<div class="section level3">
<h3 id="colors-text-rotation-and-number-formats">Colors, text rotation and number formats<a class="anchor" aria-label="anchor" href="#colors-text-rotation-and-number-formats"></a>
</h3>
<p>Below we show you two ways how to create styled tables with
<code>openxlsx2</code> one using the high level functions to style
worksheet areas and one using the bare metal approach of creating the
identical table. We show both ways to create styles in
<code>openxlsx2</code> to show how you could build on our functions or
create your very own functions.</p>
<div class="figure">
<img src="img/worksheet_styling.jpg" alt="The example below, with increased column width." width="100%"><p class="caption">
The example below, with increased column width.
</p>
</div>
<div class="section level4">
<h4 id="the-quick-way-using-high-level-functions">the quick way: using high level functions<a class="anchor" aria-label="anchor" href="#the-quick-way-using-high-level-functions"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add some dummy data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">28</span> <span class="op">*</span> <span class="fl">28</span>, mean <span class="op">=</span> <span class="fl">44444</span>, sd <span class="op">=</span> <span class="fl">555</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">28</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">border_col</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">border_sty</span> <span class="op">&lt;-</span> <span class="st">"thin"</span></span>
<span></span>
<span><span class="co"># prepare workbook with data and formated first row</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mat</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_border.html">wb_add_border</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1:AB1"</span>,</span>
<span>    top_color <span class="op">=</span> <span class="va">border_col</span>, top_border <span class="op">=</span> <span class="va">border_sty</span>,</span>
<span>    bottom_color <span class="op">=</span> <span class="va">border_col</span>, bottom_border <span class="op">=</span> <span class="va">border_sty</span>,</span>
<span>    left_color <span class="op">=</span> <span class="va">border_col</span>, left_border <span class="op">=</span> <span class="va">border_sty</span>,</span>
<span>    right_color <span class="op">=</span> <span class="va">border_col</span>, right_border <span class="op">=</span> <span class="va">border_sty</span>,</span>
<span>    inner_hcolor <span class="op">=</span> <span class="va">border_col</span>, inner_hgrid <span class="op">=</span> <span class="va">border_sty</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_fill.html">wb_add_fill</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1:AB1"</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF334E6F"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_font.html">wb_add_font</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1:AB1"</span>, name <span class="op">=</span> <span class="st">"Arial"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FFFFFFFF"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_cell_style.html">wb_add_cell_style</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1:AB1"</span>, horizontal <span class="op">=</span> <span class="st">"center"</span>, textRotation <span class="op">=</span> <span class="fl">45</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create various number formats</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>,</span>
<span>  <span class="fl">37</span>, <span class="fl">38</span>, <span class="fl">39</span>, <span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">46</span>, <span class="fl">47</span>, <span class="fl">48</span>, <span class="fl">49</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># apply the styles</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s2:%s29"</span>, <span class="fu"><a href="../reference/int2col.html">int2col</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="fu"><a href="../reference/int2col.html">int2col</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_numfmt.html">wb_add_numfmt</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="va">cell</span>, numfmt <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># wb$open()</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-long-way-using-bare-metal-functions">the long way: using bare metal functions<a class="anchor" aria-label="anchor" href="#the-long-way-using-bare-metal-functions"></a>
</h4>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create workbook</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># add some dummy data to the worksheet</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">28</span> <span class="op">*</span> <span class="fl">28</span>, mean <span class="op">=</span> <span class="fl">44444</span>, sd <span class="op">=</span> <span class="fl">555</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">28</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mat</span>, colNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a border style and assign it to the workbook</span></span>
<span><span class="va">black</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF000000"</span><span class="op">)</span></span>
<span><span class="va">new_border</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_border.html">create_border</a></span><span class="op">(</span></span>
<span>  bottom <span class="op">=</span> <span class="st">"thin"</span>, bottom_color <span class="op">=</span> <span class="va">black</span>,</span>
<span>  top <span class="op">=</span> <span class="st">"thin"</span>, top_color <span class="op">=</span> <span class="va">black</span>,</span>
<span>  left <span class="op">=</span> <span class="st">"thin"</span>, left_color <span class="op">=</span> <span class="va">black</span>,</span>
<span>  right <span class="op">=</span> <span class="st">"thin"</span>, right_color <span class="op">=</span> <span class="va">black</span></span>
<span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">new_border</span>, <span class="st">"new_border"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># create a fill style and assign it to the workbook</span></span>
<span><span class="va">new_fill</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_fill.html">create_fill</a></span><span class="op">(</span>patternType <span class="op">=</span> <span class="st">"solid"</span>, fgColor <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF334E6F"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">new_fill</span>, <span class="st">"new_fill"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a font style and assign it to the workbook</span></span>
<span><span class="va">new_font</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_font.html">create_font</a></span><span class="op">(</span>sz <span class="op">=</span> <span class="fl">20</span>, name <span class="op">=</span> <span class="st">"Arial"</span>, b <span class="op">=</span> <span class="cn">TRUE</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FFFFFFFF"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">new_font</span>, <span class="st">"new_font"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a new cell style, that uses the fill, the font and the border style</span></span>
<span><span class="va">new_cellxfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_cell_style.html">create_cell_style</a></span><span class="op">(</span></span>
<span>  num_fmt_id <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  horizontal <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  text_rotation <span class="op">=</span> <span class="fl">45</span>,</span>
<span>  fill_id <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_fill_id</span><span class="op">(</span><span class="st">"new_fill"</span><span class="op">)</span>,</span>
<span>  font_id <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_font_id</span><span class="op">(</span><span class="st">"new_font"</span><span class="op">)</span>,</span>
<span>  border_id <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_border_id</span><span class="op">(</span><span class="st">"new_border"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># assign this style to the workbook</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">new_cellxfs</span>, <span class="st">"new_styles"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assign the new cell style to the header row of our data set</span></span>
<span><span class="va">cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"A1:%s1"</span>, <span class="fu"><a href="../reference/int2col.html">int2col</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/cell_style.html">wb_set_cell_style</a></span><span class="op">(</span></span>
<span>  dims <span class="op">=</span> <span class="va">cell</span>,</span>
<span>  style <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_xf_id</span><span class="op">(</span><span class="st">"new_styles"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## style the cells with some builtin format codes (no new numFmt entry is needed)</span></span>
<span><span class="co"># add builtin style ids</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">9</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">12</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">15</span>, <span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span>, <span class="fl">19</span>, <span class="fl">20</span>, <span class="fl">21</span>, <span class="fl">22</span>,</span>
<span>  <span class="fl">37</span>, <span class="fl">38</span>, <span class="fl">39</span>, <span class="fl">40</span>, <span class="fl">45</span>, <span class="fl">46</span>, <span class="fl">47</span>, <span class="fl">48</span>, <span class="fl">49</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create styles</span></span>
<span><span class="va">new_cellxfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_cell_style.html">create_cell_style</a></span><span class="op">(</span>num_fmt_id <span class="op">=</span> <span class="va">x</span>, horizontal <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assign the styles to the workbook</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">new_cellxfs</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"new_style"</span>, <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># new styles are 1:28</span></span>
<span><span class="va">new_styles</span> <span class="op">&lt;-</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_xf</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">new_styles</span><span class="op">$</span><span class="va">id</span><span class="op">[</span><span class="va">new_styles</span><span class="op">$</span><span class="va">name</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"new_style"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">cell</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s2:%s29"</span>, <span class="fu"><a href="../reference/int2col.html">int2col</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span>, <span class="fu"><a href="../reference/int2col.html">int2col</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/cell_style.html">wb_set_cell_style</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="va">cell</span>, style <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># assign a custom tabColor</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">worksheets</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">sheetPr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/xml_node_create.html">xml_node_create</a></span><span class="op">(</span></span>
<span>  <span class="st">"sheetPr"</span>,</span>
<span>  xml_children <span class="op">=</span> <span class="fu"><a href="../reference/xml_node_create.html">xml_node_create</a></span><span class="op">(</span></span>
<span>    <span class="st">"tabColor"</span>,</span>
<span>    xml_attributes <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF00FF00"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># # look at the beauty you've created</span></span>
<span><span class="co"># wb_open(wb)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="working-with-number-formats">Working with number formats<a class="anchor" aria-label="anchor" href="#working-with-number-formats"></a>
</h2>
<p>Per default <code>openxlsx2</code> will pick up number formats for
selected R classes.</p>
<div class="section level3">
<h3 id="numfmts">numfmts<a class="anchor" aria-label="anchor" href="#numfmts"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Create Workbook object and add worksheets</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"S1"</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"S2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"Date"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">19</span>,</span>
<span>  <span class="st">"T"</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="st">"Time"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">19</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span>,</span>
<span>  <span class="st">"Cash"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"$"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="st">"Cash2"</span> <span class="op">=</span> <span class="fl">31</span><span class="op">:</span><span class="fl">50</span>,</span>
<span>  <span class="st">"hLink"</span> <span class="op">=</span> <span class="st">"https://CRAN.R-project.org/"</span>,</span>
<span>  <span class="st">"Percentage"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  <span class="st">"TinyNumbers"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1E9</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## openxlsx will apply default Excel styling for these classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash</span><span class="op">)</span>, <span class="st">"currency"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash2</span><span class="op">)</span>, <span class="st">"accounting"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">hLink</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"hyperlink"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Percentage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Percentage</span><span class="op">)</span>, <span class="st">"percentage"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">TinyNumbers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">TinyNumbers</span><span class="op">)</span>, <span class="st">"scientific"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span><span class="st">"S1"</span>, x <span class="op">=</span> <span class="va">df</span>, startRow <span class="op">=</span> <span class="fl">4</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data_table</span><span class="op">(</span><span class="st">"S2"</span>, x <span class="op">=</span> <span class="va">df</span>, startRow <span class="op">=</span> <span class="fl">4</span>, rowNames <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="numfmts2">numfmts2<a class="anchor" aria-label="anchor" href="#numfmts2"></a>
</h3>
<p>In addition, you can set the style to be picked up using
<code>openxlsx2</code> options.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="va">wb</span>, <span class="st">"test"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx2.dateFormat"</span> <span class="op">=</span> <span class="st">"yyyy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx2.datetimeFormat"</span> <span class="op">=</span> <span class="st">"yyyy-mm-dd"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="st">"openxlsx2.numFmt"</span> <span class="op">=</span> <span class="st">"â‚¬ #.0"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="st">"Date"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">19</span>,</span>
<span>  <span class="st">"T"</span> <span class="op">=</span> <span class="cn">TRUE</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="st">"Time"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">0</span><span class="op">:</span><span class="fl">19</span> <span class="op">*</span> <span class="fl">60</span> <span class="op">*</span> <span class="fl">60</span>,</span>
<span>  <span class="st">"Cash"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"$"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span>, <span class="st">"Cash2"</span> <span class="op">=</span> <span class="fl">31</span><span class="op">:</span><span class="fl">50</span>,</span>
<span>  <span class="st">"hLink"</span> <span class="op">=</span> <span class="st">"https://CRAN.R-project.org/"</span>,</span>
<span>  <span class="st">"Percentage"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>,</span>
<span>  <span class="st">"TinyNumbers"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1E9</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="st">"numeric"</span> <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">## openxlsx will apply default Excel styling for these classes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash</span><span class="op">)</span>, <span class="st">"currency"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Cash2</span><span class="op">)</span>, <span class="st">"accounting"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">hLink</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"hyperlink"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Percentage</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">Percentage</span><span class="op">)</span>, <span class="st">"percentage"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">TinyNumbers</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">TinyNumbers</span><span class="op">)</span>, <span class="st">"scientific"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span><span class="st">"test"</span>, <span class="va">df</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="modifying-the-column-widths">Modifying the column widths<a class="anchor" aria-label="anchor" href="#modifying-the-column-widths"></a>
</h2>
<div class="section level3">
<h3 id="wb_set_col_widths">wb_set_col_widths<a class="anchor" aria-label="anchor" href="#wb_set_col_widths"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_set_col_widths.html">wb_set_col_widths</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="va">cols</span>, widths <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="adding-borders">Adding borders<a class="anchor" aria-label="anchor" href="#adding-borders"></a>
</h2>
<div class="section level3">
<h3 id="add-borders">add borders<a class="anchor" aria-label="anchor" href="#add-borders"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># full inner grid</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"S1"</span>, grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_border</span><span class="op">(</span></span>
<span>  dims <span class="op">=</span> <span class="st">"A2:K33"</span>,</span>
<span>  inner_hgrid <span class="op">=</span> <span class="st">"thin"</span>, inner_hcolor <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF808080"</span><span class="op">)</span>,</span>
<span>  inner_vgrid <span class="op">=</span> <span class="st">"thin"</span>, inner_vcolor <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF808080"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># only horizontal grid</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"S2"</span>, grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_border</span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A2:K33"</span>, inner_hgrid <span class="op">=</span> <span class="st">"thin"</span>, inner_hcolor <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF808080"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># only vertical grid</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"S3"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_border</span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A2:K33"</span>, inner_vgrid <span class="op">=</span> <span class="st">"thin"</span>, inner_vcolor <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF808080"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># no inner grid</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"S4"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_border</span><span class="op">(</span><span class="st">"S4"</span>, dims <span class="op">=</span> <span class="st">"A2:K33"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="styled-table">styled table<a class="anchor" aria-label="anchor" href="#styled-table"></a>
</h3>
<p>Below we show you two ways how to create styled tables with
<code>openxlsx2</code> one using the high level functions to style
worksheet areas and one using the bare metal approach of creating the
identical table.</p>
<p><img src="img/styled_table.jpg"><!-- --></p>
<div class="section level4">
<h4 id="the-quick-way-using-high-level-functions-1">the quick way: using high level functions<a class="anchor" aria-label="anchor" href="#the-quick-way-using-high-level-functions-1"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add some dummy data to the worksheet</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mat</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span>, start_col <span class="op">=</span> <span class="fl">2</span>, start_row <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># center first row</span></span>
<span>  <span class="fu"><a href="../reference/wb_add_cell_style.html">wb_add_cell_style</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"B2:C2"</span>, horizontal <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># add border for first row</span></span>
<span>  <span class="fu"><a href="../reference/wb_add_border.html">wb_add_border</a></span><span class="op">(</span></span>
<span>    dims <span class="op">=</span> <span class="st">"B2:C2"</span>,</span>
<span>    bottom_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, bottom_border <span class="op">=</span> <span class="st">"thin"</span>,</span>
<span>    top_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, top_border <span class="op">=</span> <span class="st">"double"</span>,</span>
<span>    left_border <span class="op">=</span> <span class="cn">NULL</span>, right_border <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># add border for last row</span></span>
<span>  <span class="fu"><a href="../reference/wb_add_border.html">wb_add_border</a></span><span class="op">(</span></span>
<span>    dims <span class="op">=</span> <span class="st">"B4:C4"</span>,</span>
<span>    bottom_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, bottom_border <span class="op">=</span> <span class="st">"double"</span>,</span>
<span>    top_border <span class="op">=</span> <span class="cn">NULL</span>, left_border <span class="op">=</span> <span class="cn">NULL</span>, right_border <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="the-long-way-creating-everything-from-the-bone">the long way: creating everything from the bone<a class="anchor" aria-label="anchor" href="#the-long-way-creating-everything-from-the-bone"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># add some dummy data to the worksheet</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/make.names.html" class="external-link">make.names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"test"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mat</span>, startCol <span class="op">=</span> <span class="fl">2</span>, startRow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a border style and assign it to the workbook</span></span>
<span><span class="va">black</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF000000"</span><span class="op">)</span></span>
<span><span class="va">top_border</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_border.html">create_border</a></span><span class="op">(</span></span>
<span>  top <span class="op">=</span> <span class="st">"double"</span>, top_color <span class="op">=</span> <span class="va">black</span>,</span>
<span>  bottom <span class="op">=</span> <span class="st">"thin"</span>, bottom_color <span class="op">=</span> <span class="va">black</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">bottom_border</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_border.html">create_border</a></span><span class="op">(</span>bottom <span class="op">=</span> <span class="st">"double"</span>, bottom_color <span class="op">=</span> <span class="va">black</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">top_border</span>, <span class="st">"top_border"</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">bottom_border</span>, <span class="st">"bottom_border"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a new cell style, that uses the fill, the font and the border style</span></span>
<span><span class="va">top_cellxfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_cell_style.html">create_cell_style</a></span><span class="op">(</span></span>
<span>  numFmtId <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  horizontal <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  borderId <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_border_id</span><span class="op">(</span><span class="st">"top_border"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">bottom_cellxfs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_cell_style.html">create_cell_style</a></span><span class="op">(</span></span>
<span>  numFmtId <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  borderId <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_border_id</span><span class="op">(</span><span class="st">"bottom_border"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assign this style to the workbook</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">top_cellxfs</span>, <span class="st">"top_styles"</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">add</span><span class="op">(</span><span class="va">bottom_cellxfs</span>, <span class="st">"bottom_styles"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># assign the new cell style to the header row of our data set</span></span>
<span><span class="va">cell</span> <span class="op">&lt;-</span> <span class="st">"B2:C2"</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/cell_style.html">wb_set_cell_style</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="va">cell</span>, style <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_xf_id</span><span class="op">(</span><span class="st">"top_styles"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cell</span> <span class="op">&lt;-</span> <span class="st">"B4:C4"</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/cell_style.html">wb_set_cell_style</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="va">cell</span>, style <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_xf_id</span><span class="op">(</span><span class="st">"bottom_styles"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="use-workbook-colors-and-modify-them">Use workbook colors and modify them<a class="anchor" aria-label="anchor" href="#use-workbook-colors-and-modify-them"></a>
</h2>
<p>The loop below will apply the tint attribute to the fill color</p>
<div class="figure">
<img src="img/color_tint.jpg" alt="Tint variations of the theme colors." width="100%"><p class="caption">
Tint variations of the theme colors.
</p>
</div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"S1"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tints</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.9</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">0</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">tnt</span> <span class="kw">in</span> <span class="va">tints</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">col</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="../reference/int2col.html">int2col</a></span><span class="op">(</span><span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">tints</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">tnt</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">tnt</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_fill.html">wb_add_fill</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="va">col</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="va">i</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>      <span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_fill.html">wb_add_fill</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="va">col</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>theme <span class="op">=</span> <span class="va">i</span>, tint <span class="op">=</span> <span class="va">tnt</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="copy-cell-styles">Copy cell styles<a class="anchor" aria-label="anchor" href="#copy-cell-styles"></a>
</h2>
<p>It is possible to copy the styles of several cells at once. In the
following example, the styles of some cells from a formatted workbook
are applied to a previously empty cell range. Be careful though,
<code><a href="../reference/cell_style.html">wb_get_cell_style()</a></code> returns only some styles, so you have
to make sure that the copy-from and copy-to dimensions match in a
meaningful way.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_load.html">wb_load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"oxlsx2_sheet.xlsx"</span>, package <span class="op">=</span> <span class="st">"openxlsx2"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/cell_style.html">wb_set_cell_style</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"A30:G35"</span>, <span class="fu"><a href="../reference/cell_style.html">wb_get_cell_style</a></span><span class="op">(</span><span class="va">.</span>, <span class="fl">1</span>, <span class="st">"A10:G15"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># wb_open(wb)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="style-strings">Style strings<a class="anchor" aria-label="anchor" href="#style-strings"></a>
</h2>
<p>Using <code><a href="../reference/fmt_txt.html">fmt_txt()</a></code> is possible to style strings
independently of the cell containing the string.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">txt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/fmt_txt.html">fmt_txt</a></span><span class="op">(</span><span class="st">"Embracing the full potential of "</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/fmt_txt.html">fmt_txt</a></span><span class="op">(</span><span class="st">"openxlsx2"</span>, bold <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/fmt_txt.html">fmt_txt</a></span><span class="op">(</span><span class="st">" with "</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/fmt_txt.html">fmt_txt</a></span><span class="op">(</span><span class="st">"fmt_txt()"</span>, font <span class="op">=</span> <span class="st">"Courier"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/fmt_txt.html">fmt_txt</a></span><span class="op">(</span><span class="st">" !"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">txt</span><span class="op">)</span></span></code></pre></div>
<p>As shown above it is possible to combine multiple styles together
into a longer string. It is even possible to use <code><a href="../reference/fmt_txt.html">fmt_txt()</a></code>
as <code>na.strings</code>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">mtcars</span></span>
<span><span class="va">df</span><span class="op">[</span><span class="va">df</span> <span class="op">&lt;</span> <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="va">na_red</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fmt_txt.html">fmt_txt</a></span><span class="op">(</span><span class="st">"N/A"</span>, color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>, italic <span class="op">=</span> <span class="cn">TRUE</span>, bold <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">df</span>, na.strings <span class="op">=</span> <span class="va">na_red</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="create-custom-table-styles">Create custom table styles<a class="anchor" aria-label="anchor" href="#create-custom-table-styles"></a>
</h2>
<p>With <code><a href="../reference/create_tablestyle.html">create_tablestyle()</a></code> it is possible to create your
own table styles. This function uses <code><a href="../reference/create_dxfs_style.html">create_dxfs_style()</a></code>
(just like your spreadsheet software does). Therefore, it is not quite
as user-friendly. The following example shows how the function creates a
red table style. The various dxfs styles must be created and assigned to
the workbook (similar styles are used in conditional formatting). In
<code><a href="../reference/create_tablestyle.html">create_tablestyle()</a></code> these styles are assigned to the table
style elements. Once the table style is created, it must also be
assigned to the workbook. After that you can use it in the workbook like
any other table style.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># a red table style</span></span>
<span><span class="va">dx0</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  left_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  right_color <span class="op">=</span> <span class="cn">NULL</span>, right_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_color <span class="op">=</span> <span class="cn">NULL</span>, top_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bottom_color <span class="op">=</span> <span class="cn">NULL</span>, bottom_style <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in standardize_case_names(rtns, return = TRUE, arguments = arguments):</span></span>
<span><span class="co">#&gt; unused arguments (left_color, right_color, right_style, top_color, top_style,</span></span>
<span><span class="co">#&gt; bottom_color, bottom_style)</span></span>
<span></span>
<span><span class="va">dx1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  left_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  right_color <span class="op">=</span> <span class="cn">NULL</span>, right_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_color <span class="op">=</span> <span class="cn">NULL</span>, top_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bottom_color <span class="op">=</span> <span class="cn">NULL</span>, bottom_style <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in standardize_case_names(rtns, return = TRUE, arguments = arguments):</span></span>
<span><span class="co">#&gt; unused arguments (left_color, right_color, right_style, top_color, top_style,</span></span>
<span><span class="co">#&gt; bottom_color, bottom_style)</span></span>
<span></span>
<span><span class="va">dx2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  top_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  left_color <span class="op">=</span> <span class="cn">NULL</span>, left_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  right_color <span class="op">=</span> <span class="cn">NULL</span>, right_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bottom_color <span class="op">=</span> <span class="cn">NULL</span>, bottom_style <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in standardize_case_names(rtns, return = TRUE, arguments = arguments):</span></span>
<span><span class="co">#&gt; unused arguments (top_color, left_color, left_style, right_color, right_style,</span></span>
<span><span class="co">#&gt; bottom_color, bottom_style)</span></span>
<span></span>
<span><span class="va">dx3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  top_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  left_color <span class="op">=</span> <span class="cn">NULL</span>, left_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  right_color <span class="op">=</span> <span class="cn">NULL</span>, right_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bottom_color <span class="op">=</span> <span class="cn">NULL</span>, bottom_style <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in standardize_case_names(rtns, return = TRUE, arguments = arguments):</span></span>
<span><span class="co">#&gt; unused arguments (top_color, left_color, left_style, right_color, right_style,</span></span>
<span><span class="co">#&gt; bottom_color, bottom_style)</span></span>
<span></span>
<span><span class="va">dx4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  text_bold <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dx5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  text_bold <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dx6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  font_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  text_bold <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  top_style <span class="op">=</span> <span class="st">"double"</span>,</span>
<span>  left_color <span class="op">=</span> <span class="cn">NULL</span>, left_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  right_color <span class="op">=</span> <span class="cn">NULL</span>, right_style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  bottom_color <span class="op">=</span> <span class="cn">NULL</span>, bottom_style <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in standardize_case_names(rtns, return = TRUE, arguments = arguments):</span></span>
<span><span class="co">#&gt; unused arguments (top_style, left_color, left_style, right_color, right_style,</span></span>
<span><span class="co">#&gt; bottom_color, bottom_style)</span></span>
<span></span>
<span><span class="va">dx7</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  font_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"white"</span><span class="op">)</span>,</span>
<span>  text_bold <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bgFill <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  fgColor <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dx8</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_dxfs_style.html">create_dxfs_style</a></span><span class="op">(</span></span>
<span>  border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  left_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  top_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  right_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,</span>
<span>  bottom_color <span class="op">=</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in standardize_case_names(rtns, return = TRUE, arguments = arguments):</span></span>
<span><span class="co">#&gt; unused arguments (left_color, top_color, right_color, bottom_color)</span></span>
<span></span>
<span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span>grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx0</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx1</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx2</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx3</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx4</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx5</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx6</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx7</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">dx8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># finally create the table</span></span>
<span><span class="va">xml</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_tablestyle.html">create_tablestyle</a></span><span class="op">(</span></span>
<span>  name                 <span class="op">=</span> <span class="st">"red_table"</span>,</span>
<span>  whole_table          <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx8"</span><span class="op">)</span>,</span>
<span>  header_row           <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx7"</span><span class="op">)</span>,</span>
<span>  total_row            <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx6"</span><span class="op">)</span>,</span>
<span>  first_column         <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx5"</span><span class="op">)</span>,</span>
<span>  last_column          <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx4"</span><span class="op">)</span>,</span>
<span>  first_row_stripe     <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx3"</span><span class="op">)</span>,</span>
<span>  second_row_stripe    <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx2"</span><span class="op">)</span>,</span>
<span>  first_column_stripe  <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx1"</span><span class="op">)</span>,</span>
<span>  second_column_stripe <span class="op">=</span> <span class="va">wb</span><span class="op">$</span><span class="va">styles_mgr</span><span class="op">$</span><span class="fu">get_dxf_id</span><span class="op">(</span><span class="st">"dx0"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_style</span><span class="op">(</span><span class="va">xml</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a table and apply the custom style</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data_table.html">wb_add_data_table</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span>, table_style <span class="op">=</span> <span class="st">"red_table"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jordan Mark Barbone, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
