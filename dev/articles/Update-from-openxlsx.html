<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Upgrade from openxlsx • openxlsx2</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Upgrade from openxlsx">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">openxlsx2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.11.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/openxlsx2.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/conditional-formatting.html">Add conditional formatting to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_charts_manual.html">Add charts to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_formulas_manual.html">Add formulas to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_read_to_df.html">openxlsx2 read to data frame manual</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_style_manual.html">Add styling to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/Update-from-openxlsx.html">Upgrade from openxlsx</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JanMarvin/openxlsx2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Upgrade from openxlsx</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JanMarvin/openxlsx2/blob/main/vignettes/Update-from-openxlsx.Rmd" class="external-link"><code>vignettes/Update-from-openxlsx.Rmd</code></a></small>
      <div class="d-none name"><code>Update-from-openxlsx.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="basic-read-and-write-functions">Basic read and write functions<a class="anchor" aria-label="anchor" href="#basic-read-and-write-functions"></a>
</h2>
<p>Welcome to the <code>openxlsx2</code> update vignette. In this
vignette we will take some common code examples from
<code>openxlsx</code> and show you how similar results can be replicated
in <code>openxlsx2</code>. Thank you for taking a look, and let’s get
started. While previous <code>openxlsx</code> functions used the
<code>.</code> in function calls, as well as camelCase, we have tried to
switch to snake_case (this is still a work in progress, there may still
be function arguments that use camelCase).</p>
<div class="section level3">
<h3 id="read-xlsx-or-xlsm-files">Read xlsx or xlsm files<a class="anchor" aria-label="anchor" href="#read-xlsx-or-xlsm-files"></a>
</h3>
<p>The basic read function changed from <code>read.xlsx</code> to
<code>read_xlsx</code>. Using a default xlsx file included in the
package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"openxlsx2_example.xlsx"</span>, package <span class="op">=</span> <span class="st">"openxlsx2"</span><span class="op">)</span></span></code></pre></div>
<p>The old syntax looked like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in openxlsx</span></span>
<span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu">read.xlsx</span><span class="op">(</span>xlsxFile <span class="op">=</span> <span class="va">file</span><span class="op">)</span></span></code></pre></div>
<p>This has changed to this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in openxlsx2</span></span>
<span><span class="fu">openxlsx2</span><span class="fu">::</span><span class="fu"><a href="../reference/wb_to_df.html">read_xlsx</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">file</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Var1 Var2 NA  Var3  Var4       Var5         Var6    Var7     Var8</span></span>
<span><span class="co">## 3   TRUE    1 NA     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span></span>
<span><span class="co">## 4   TRUE   NA NA #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span></span>
<span><span class="co">## 5   TRUE    2 NA  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span></span>
<span><span class="co">## 6  FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span></span>
<span><span class="co">## 7  FALSE    3 NA  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">## 8  FALSE    1 NA   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span></span>
<span><span class="co">## 9     NA   NA NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">## 10 FALSE    2 NA    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span></span>
<span><span class="co">## 11 FALSE    3 NA  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span></span>
<span><span class="co">## 12    NA    1 NA   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span></span></code></pre>
<p>As you can see, we return the spreadsheet return codes (e.g.,
<code>#NUM</code>) in openxlsx2. Another thing to see above, we return
the cell row as rowname for the data frame returned.
<code>openxlsx2</code> should return a data frame of the selected size,
even if it empty. If you preferred <code>openxlsx::readWorkbook()</code>
this has become <code><a href="../reference/wb_to_df.html">wb_read()</a></code>. All of these are wrappers for
the newly introduced function <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> which provides the
most options. <code><a href="../reference/wb_to_df.html">read_xlsx()</a></code> and <code><a href="../reference/wb_to_df.html">wb_read()</a></code> were
created for backward comparability.</p>
</div>
</div>
<div class="section level2">
<h2 id="write-xlsx-files">Write xlsx files<a class="anchor" aria-label="anchor" href="#write-xlsx-files"></a>
</h2>
<p>Basic writing in <code>openxlsx2</code> behaves identical to
<code>openxlsx</code>. Though be aware that <code>overwrite</code> is an
optional parameter in <code>openxlsx2</code> and just like in other
functions like <code>base::write.csv()</code> if you write onto an
existing file name, this file will be replaced.</p>
<p>Setting the output to some temporary xlsx file</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/temp_xlsx.html">temp_xlsx</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The previous write function looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># write in openxlsx</span></span>
<span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu">write.xlsx</span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="va">output</span>, colNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The new function looks quite similar:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># write in openxlsx2</span></span>
<span><span class="fu">openxlsx2</span><span class="fu">::</span><span class="fu"><a href="../reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="va">output</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-workbook-functions">Basic workbook functions<a class="anchor" aria-label="anchor" href="#basic-workbook-functions"></a>
</h2>
<p>Workbook functions have been renamed to begin with <code>wb_</code>
there are plenty of these in the package, therefore looking at the man
pages seems to be the fastest way. Yet, it all begins with loading the
workbook.</p>
<div class="section level3">
<h3 id="loading-a-workbook">Loading a workbook<a class="anchor" aria-label="anchor" href="#loading-a-workbook"></a>
</h3>
<p>A major feature in <code>openxlsx</code> are workbooks. Obviously
they remain a central piece in <code>openxlsx2</code>. Previous you
would load them with:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu">loadWorkbook</span><span class="op">(</span>file <span class="op">=</span> <span class="va">file</span><span class="op">)</span></span></code></pre></div>
<p>In <code>openxlsx2</code> loading was changed to:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_load.html">wb_load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">file</span><span class="op">)</span></span></code></pre></div>
<p>There are plenty of functions to interact with workbooks and we will
not describe every single one here. A detailed list can be found over at
<a href="https://janmarvin.github.io/openxlsx2/reference/index.html">our
references</a></p>
</div>
<div class="section level3">
<h3 id="styles">Styles<a class="anchor" aria-label="anchor" href="#styles"></a>
</h3>
<p>One of the biggest user facing change was the removal of the
<code>stylesObject</code>. In the following section we use code from <a href="https://ycphs.github.io/openxlsx/reference/addStyle.html" class="external-link"><code>openxlsx::addStyle()</code></a></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx</span></span>
<span><span class="co">## Create a new workbook</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu">createWorkbook</span><span class="op">(</span>creator <span class="op">=</span> <span class="st">"My name here"</span><span class="op">)</span></span>
<span><span class="fu">addWorksheet</span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Expenditure"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">writeData</span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, <span class="va">USPersonalExpenditure</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## style for body</span></span>
<span><span class="va">bodyStyle</span> <span class="op">&lt;-</span> <span class="fu">createStyle</span><span class="op">(</span>border <span class="op">=</span> <span class="st">"TopBottom"</span>, borderColor <span class="op">=</span> <span class="st">"#4F81BD"</span><span class="op">)</span></span>
<span><span class="fu">addStyle</span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, <span class="va">bodyStyle</span>, rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">6</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, gridExpand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## set column width for row names column</span></span>
<span><span class="fu">setColWidths</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, cols <span class="op">=</span> <span class="fl">1</span>, widths <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span></code></pre></div>
<p>In <code>openxlsx2</code> the same code looks something like
this:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2 chained</span></span>
<span><span class="va">border_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"4F81BD"</span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span>creator <span class="op">=</span> <span class="st">"My name here"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"Expenditure"</span>, grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">USPersonalExpenditure</span>, row_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_border</span><span class="op">(</span> <span class="co"># add the outer and inner border</span></span>
<span>    dims <span class="op">=</span> <span class="st">"A1:F6"</span>,</span>
<span>    top_border <span class="op">=</span> <span class="st">"thin"</span>, top_color <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    bottom_border <span class="op">=</span> <span class="st">"thin"</span>, bottom_color <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    inner_hgrid <span class="op">=</span> <span class="st">"thin"</span>, inner_hcolor <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    left_border <span class="op">=</span> <span class="st">""</span>, right_border <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">set_col_widths</span><span class="op">(</span> <span class="co"># set column width</span></span>
<span>    cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span> <span class="co"># remove the value in A1</span></span>
<span>  <span class="fu">add_data</span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>The code above uses chaining. If you prefer piping, we provide the
chained functions with the prefix <code>wb_</code> so
<code><a href="../reference/wb_add_worksheet.html">wb_add_worksheet()</a></code>, <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code>,
<code><a href="../reference/wb_add_border.html">wb_add_border()</a></code> and <code><a href="../reference/col_widths-wb.html">wb_set_col_widths()</a></code> would
be the functions to use with pipes <code>%&gt;%</code> or
<code>|&gt;</code>.</p>
<p>With pipes the code from above becomes</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2 with pipes</span></span>
<span><span class="va">border_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"4F81BD"</span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span>creator <span class="op">=</span> <span class="st">"My name here"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"Expenditure"</span>, grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">USPersonalExpenditure</span>, row_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_border.html">wb_add_border</a></span><span class="op">(</span> <span class="co"># add the outer and inner border</span></span>
<span>    dims <span class="op">=</span> <span class="st">"A1:F6"</span>,</span>
<span>    top_border <span class="op">=</span> <span class="st">"thin"</span>, top_color <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    bottom_border <span class="op">=</span> <span class="st">"thin"</span>, bottom_color <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    inner_hgrid <span class="op">=</span> <span class="st">"thin"</span>, inner_hcolor <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    left_border <span class="op">=</span> <span class="st">""</span>, right_border <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/col_widths-wb.html">wb_set_col_widths</a></span><span class="op">(</span> <span class="co"># set column width</span></span>
<span>    cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># remove the value in A1</span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>Be aware that chains modify an object in place and pipes do not.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2</span></span>
<span><span class="va">wbp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">wbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># need to assign wbp</span></span>
<span><span class="va">wbp</span> <span class="op">&lt;-</span> <span class="va">wbp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">wbc</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p>You can re-use styles with <code><a href="../reference/wb_cell_style.html">wb_get_cell_style()</a></code> and
<code><a href="../reference/wb_cell_style.html">wb_set_cell_style()</a></code>. Abandoning <code>stylesObject</code>
in <code>openxlsx2</code> has the huge benefit that we can import and
export a spreadsheet without changing any cell style. It is still
possible to modify a cell style with <code><a href="../reference/wb_add_border.html">wb_add_border()</a></code>,
<code><a href="../reference/wb_add_fill.html">wb_add_fill()</a></code>, <code><a href="../reference/wb_add_font.html">wb_add_font()</a></code> and
<code><a href="../reference/wb_add_numfmt.html">wb_add_numfmt()</a></code>.</p>
<p>Additional examples regarding styles can be found in the styles
vignette.</p>
</div>
<div class="section level3">
<h3 id="conditional-formatting">Conditional formatting<a class="anchor" aria-label="anchor" href="#conditional-formatting"></a>
</h3>
<p>See <code><a href="../articles/conditional-formatting.html">vignette("conditional-formatting")</a></code> for extended
examples on formatting.</p>
<p>Here is a minimal example:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2 with chains</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_conditional_formatting</span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1:A4"</span>, rule <span class="op">=</span> <span class="st">"&gt;2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># openxlsx2 with pipes</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_conditional_formatting.html">wb_add_conditional_formatting</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1:A4"</span>, rule <span class="op">=</span> <span class="st">"&gt;2"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-validation">Data validation<a class="anchor" aria-label="anchor" href="#data-validation"></a>
</h3>
<p>Similarly, data validation has been updated and improved. This
<code>openxlsx</code> code for data validation</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu">createWorkbook</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">addWorksheet</span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Sheet 1"</span><span class="op">)</span></span>
<span><span class="fu">writeDataTable</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">dataValidation</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>,</span>
<span>  col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">31</span>, type <span class="op">=</span> <span class="st">"whole"</span>,</span>
<span>  operator <span class="op">=</span> <span class="st">"between"</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>looks in <code>openxlsx2</code> something like this:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2 with chains</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"Sheet 1"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data_table</span><span class="op">(</span><span class="fl">1</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data_validation</span><span class="op">(</span><span class="fl">1</span>,</span>
<span>    dims <span class="op">=</span> <span class="fu"><a href="../reference/wb_dims.html">wb_dims</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">31</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="co"># alternatively, dims can also be "A2:C31" if you know the span in your Excel workbook.</span></span>
<span>    type <span class="op">=</span> <span class="st">"whole"</span>,</span>
<span>    operator <span class="op">=</span> <span class="st">"between"</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># openxlsx2 with pipes</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"Sheet 1"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data_table.html">wb_add_data_table</a></span><span class="op">(</span><span class="fl">1</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data_validation.html">wb_add_data_validation</a></span><span class="op">(</span></span>
<span>    sheet <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    dims <span class="op">=</span> <span class="st">"A2:C31"</span>, <span class="co"># alternatively, dims = wb_dims(rows = 2:31, cols = 1:3)</span></span>
<span>    type <span class="op">=</span> <span class="st">"whole"</span>,</span>
<span>    operator <span class="op">=</span> <span class="st">"between"</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="saving">Saving<a class="anchor" aria-label="anchor" href="#saving"></a>
</h3>
<p>Saving has been switched from <code>saveWorkbook()</code> to
<code><a href="../reference/wb_save.html">wb_save()</a></code> and opening a workbook has been switched from
<code>openXL()</code> to <code><a href="../reference/wb_open.html">wb_open()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="why-openxlsx2">Why <code>openxlsx2</code>?<a class="anchor" aria-label="anchor" href="#why-openxlsx2"></a>
</h2>
<p>Originally, <code>openxlsx2</code> was started as a private branch of
<code>openxlsx</code> to include the pugixml library and provide a fully
functional XML parser for <code>openxlsx</code>. At that time, it became
clear that the home-written <code>openxlsx</code> XML parser was limited
in its ability to reliably parse XML files, leading to some problems
with broken and unreadable xlsx files. Once the inclusion of pugixml was
addressed, a new internal structure was created, and this structure
required changes to most of the old <code>openxlsx</code> functions.
This was accompanied by the change from <code>methods</code> to
<code>R6</code> and the possibility of chaining and piping
functions.</p>
<p>Working with the styles object of <code>openxlsx</code> it became
clear that while it is a great idea, it does not work well enough for
our needs and that files loaded and modified by <code>openxlsx</code>
never look the same. There are always things that look a little off
because the style objects do not work perfectly. Likewise, there are a
lot of edge cases in <code>openxlsx</code> that assume a file structure
in xlsx objects that is a simplified approximation of what is actually
going on. For example, <code>openxlsx</code> assumes that each sheet is
accompanied by a drawing. While this works in many cases, it does not
match the definition of the format in the openxml standard. There may be
worksheets with multiple drawings, and there should be no drawing folder
if no drawings are included. Unfortunately, many of these things are
deeply embedded in the <code>openxlsx</code> code, and the more
development that took place in <code>openxlsx2</code>, the more things
differed between the fork from its origin. At some point the fork was
called an independent project and the previously privately developed
branch was made public.</p>
<p>You could say that this went hand in hand with the modification of
the actual project goal. Before, it was about creating a similar looking
xlsx file and being able to partially edit it. Now it was about writing
an identical xlsx file and just being able to change everything.</p>
<p>Since then most of the internal functions of <code>openxlsx</code>
have been cleaned up, fixed and mostly rewritten. The package has
developed new ways to handle styles with the styles manager, it provides
a full range of style options that would be hard or impossible to
include in <code>openxlsx</code>. We have included support for native
graphs with <code>mschart</code> and feature the creation of pivot
tables. We support more conditional formatting options, we have improved
the support for data validation, we have sparklines and form control
objects. In addition many of the quirks of the old package have been
ironed out. We have switched to a consistent and stable API build on
<code>dims</code> and we provide multiple vignettes to document our code
and plenty of functions to interact with the <code>openxml</code>
format. We provide basic <code>xlsb</code> support and with <a href="https://github.com/JanMarvin/msoc" class="external-link"><code>msoc</code></a> we have
created a package encrypt and decrypt <code>openxml</code> files.</p>
</div>
<div class="section level2">
<h2 id="invitation-to-contribute">Invitation to contribute<a class="anchor" aria-label="anchor" href="#invitation-to-contribute"></a>
</h2>
<p>We have put a lot of work into <code>openxls2</code> to make it
useful for our needs, improving what we found useful about
<code>openxlsx</code> and removing what we didn’t need. We do not claim
to be omniscient about all the things you can do with spreadsheet
software, nor do we claim to be omniscient about all the things you can
do in <code>openxlsx2</code>. The package is still under active
development, though we have reached a semi stable API that will not
change until the next major release.</p>
<p>We are quite fond of our little package and invite others to try it
out and comment on what they like and of course what they think we are
missing or if something doesn’t work. <code>openxlsx2</code> is a
complex piece of software that certainly does not work bug-free, even if
we did our best. If you want to contribute to the development of
<code>openxlsx2</code>, please be our guest on our Github. Join or open
a discussion, post or fix issues or write us a mail.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jordan Mark Barbone, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
