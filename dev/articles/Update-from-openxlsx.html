<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="openxlsx2">
<title>Upgrade from openxlsx • openxlsx2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Upgrade from openxlsx">
<meta property="og:description" content="openxlsx2">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openxlsx2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/openxlsx2.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Update-from-openxlsx.html">Upgrade from openxlsx</a>
    <a class="dropdown-item" href="../articles/conditional-formatting.html">Conditional Formatting</a>
    <a class="dropdown-item" href="../articles/openxlsx2_charts_manual.html">openxlsx2 charts manual</a>
    <a class="dropdown-item" href="../articles/openxlsx2_formulas_manual.html">openxlsx2 formulas manual</a>
    <a class="dropdown-item" href="../articles/openxlsx2_style_manual.html">openxlsx2 style manual</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JanMarvin/openxlsx2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Upgrade from openxlsx</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JanMarvin/openxlsx2/blob/HEAD/vignettes/Update-from-openxlsx.Rmd" class="external-link"><code>vignettes/Update-from-openxlsx.Rmd</code></a></small>
      <div class="d-none name"><code>Update-from-openxlsx.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="basic-read-and-write-functions">Basic read and write functions<a class="anchor" aria-label="anchor" href="#basic-read-and-write-functions"></a>
</h2>
<p>Welcome to the <code>openxlsx2</code> update vignette. In this
vignette we will take some common code examples from
<code>openxlsx</code> and show you how similar results can be replicated
in <code>openxlsx2</code>. Thank you for taking a look, and let’s get
started. While previous <code>openxlsx</code> functions used the
<code>.</code> in function calls, as well as camelCase, we have tried to
switch to snake_case (this is still a work in progress, there may still
be function arguments that use camelCase).</p>
<div class="section level3">
<h3 id="read-xlsx-or-xlsm-files">Read xlsx or xlsm files<a class="anchor" aria-label="anchor" href="#read-xlsx-or-xlsm-files"></a>
</h3>
<p>The basic read function changed from <code>read.xlsx</code> to
<code>read_xlsx</code>. Using a default xlsx file included in the
package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xlsx_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"openxlsx2_example.xlsx"</span>, package <span class="op">=</span> <span class="st">"openxlsx2"</span><span class="op">)</span></span></code></pre></div>
<p>The old syntax looked like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in openxlsx</span></span>
<span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu">read.xlsx</span><span class="op">(</span>xlsxFile <span class="op">=</span> <span class="va">xlsx_file</span><span class="op">)</span></span></code></pre></div>
<p>This has changed to this:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in openxlsx2</span></span>
<span><span class="fu">openxlsx2</span><span class="fu">::</span><span class="fu"><a href="../reference/wb_to_df.html">read_xlsx</a></span><span class="op">(</span>xlsx_file <span class="op">=</span> <span class="va">xlsx_file</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     Var1 Var2 NA  Var3  Var4       Var5         Var6    Var7     Var8</span></span>
<span><span class="co">## 3   TRUE    1 NA     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span></span>
<span><span class="co">## 4   TRUE   NA NA #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span></span>
<span><span class="co">## 5   TRUE    2 NA  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span></span>
<span><span class="co">## 6  FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span></span>
<span><span class="co">## 7  FALSE    3 NA  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">## 8  FALSE    1 NA   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span></span>
<span><span class="co">## 9     NA   NA NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span></span>
<span><span class="co">## 10 FALSE    2 NA    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span></span>
<span><span class="co">## 11 FALSE    3 NA  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span></span>
<span><span class="co">## 12    NA    1 NA   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span></span></code></pre>
<p>As you can see, we return the spreadsheet return codes (e.g.,
<code>#NUM</code>) in openxlsx2. Another thing to see above, we return
the cell row as rowname for the data frame returned.
<code>openxlsx2</code> should return a data frame of the selected size,
even if it empty. If you preferred <code>openxlsx::readWorkbook()</code>
this has become <code><a href="../reference/wb_to_df.html">wb_read()</a></code>. All of these are wrappers for
the newly introduced function <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> which provides the
most options. <code><a href="../reference/wb_to_df.html">read_xlsx()</a></code> and <code><a href="../reference/wb_to_df.html">wb_read()</a></code> were
created for backward comparability.</p>
</div>
</div>
<div class="section level2">
<h2 id="write-xlsx-files">Write xlsx files<a class="anchor" aria-label="anchor" href="#write-xlsx-files"></a>
</h2>
<p>Basic writing in <code>openxlsx2</code> behaves identical to
<code>openxlsx</code>. Though be aware that <code>overwrite</code> is an
optional parameter in <code>openxlsx2</code> and just like in other
functions like <code>base::write.csv()</code> if you write onto an
existing file name, this file will be replaced.</p>
<p>Setting the output to some temporary xlsx file</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/temp_xlsx.html">temp_xlsx</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The previous write function looks like this:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># write in openxlsx</span></span>
<span><span class="fu">openxlsx</span><span class="fu">::</span><span class="fu">write.xlsx</span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="va">output</span>, colNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The new function looks quite similar:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># write in openxlsx2</span></span>
<span><span class="fu">openxlsx2</span><span class="fu">::</span><span class="fu"><a href="../reference/write_xlsx.html">write_xlsx</a></span><span class="op">(</span><span class="va">iris</span>, file <span class="op">=</span> <span class="va">output</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-workbook-functions">Basic workbook functions<a class="anchor" aria-label="anchor" href="#basic-workbook-functions"></a>
</h2>
<p>Workbook functions have been renamed to begin with <code>wb_</code>
there are plenty of these in the package, therefore looking at the man
pages seems to be the fastest way. Yet, it all begins with loading the
workbook.</p>
<div class="section level3">
<h3 id="loading-a-workbook">Loading a workbook<a class="anchor" aria-label="anchor" href="#loading-a-workbook"></a>
</h3>
<p>A major feature in <code>openxlsx</code> are workbooks. Obviously
they remain a central piece in <code>openxlsx2</code>. Previous you
would load them with:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu">openxlsx</span><span class="fu">::</span><span class="fu">loadWorkbook</span><span class="op">(</span>file <span class="op">=</span> <span class="va">xlsx_file</span><span class="op">)</span></span></code></pre></div>
<p>In <code>openxlsx2</code> loading was changed to:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_load.html">wb_load</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">xlsx_file</span><span class="op">)</span></span></code></pre></div>
<p>There are plenty of functions to interact with workbooks and we will
not describe every single one here. A detailed list can be found over at
<a href="https://janmarvin.github.io/openxlsx2/reference/index.html">our
references</a></p>
</div>
<div class="section level3">
<h3 id="styles">Styles<a class="anchor" aria-label="anchor" href="#styles"></a>
</h3>
<p>One of the biggest user facing change was the removal of the
<code>stylesObject</code>. In the following section we use code from <a href="https://ycphs.github.io/openxlsx/reference/addStyle.html" class="external-link"><code>openxlsx::addStyle()</code></a></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx</span></span>
<span><span class="co">## Create a new workbook</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu">createWorkbook</span><span class="op">(</span>creator <span class="op">=</span> <span class="st">"My name here"</span><span class="op">)</span></span>
<span><span class="fu">addWorksheet</span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Expenditure"</span>, gridLines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">writeData</span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, <span class="va">USPersonalExpenditure</span>, rowNames <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## style for body</span></span>
<span><span class="va">bodyStyle</span> <span class="op">&lt;-</span> <span class="fu">createStyle</span><span class="op">(</span>border <span class="op">=</span> <span class="st">"TopBottom"</span>, borderColor <span class="op">=</span> <span class="st">"#4F81BD"</span><span class="op">)</span></span>
<span><span class="fu">addStyle</span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span>, <span class="va">bodyStyle</span>, rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">6</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, gridExpand <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## set column width for row names column</span></span>
<span><span class="fu">setColWidths</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, cols <span class="op">=</span> <span class="fl">1</span>, widths <span class="op">=</span> <span class="fl">21</span><span class="op">)</span></span></code></pre></div>
<p>In <code>openxlsx2</code> the same code looks something like
this:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2 chained</span></span>
<span><span class="va">border_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF4F81BD"</span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span>creator <span class="op">=</span> <span class="st">"My name here"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"Expenditure"</span>, grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">USPersonalExpenditure</span>, row_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_border</span><span class="op">(</span> <span class="co"># add the outer and inner border</span></span>
<span>    dims <span class="op">=</span> <span class="st">"A1:F6"</span>,</span>
<span>    top_border <span class="op">=</span> <span class="st">"thin"</span>, top_color <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    bottom_border <span class="op">=</span> <span class="st">"thin"</span>, bottom_color <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    inner_hgrid <span class="op">=</span> <span class="st">"thin"</span>, inner_hcolor <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    left_border <span class="op">=</span> <span class="st">""</span>, right_border <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">set_col_widths</span><span class="op">(</span> <span class="co"># set column width</span></span>
<span>    cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span> <span class="co"># remove the value in A1</span></span>
<span>  <span class="fu">add_data</span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>The code above uses chaining. If you prefer piping, we provide the
chained functions with the prefix <code>wb_</code> so
<code><a href="../reference/wb_add_worksheet.html">wb_add_worksheet()</a></code>, <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code>,
<code><a href="../reference/wb_add_border.html">wb_add_border()</a></code> and <code><a href="../reference/wb_set_col_widths.html">wb_set_col_widths()</a></code> would
be the functions to use with pipes <code>%&gt;%</code> or
<code>|&gt;</code>.</p>
<p>With pipes the code from above becomes</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2 with pipes</span></span>
<span><span class="va">border_color</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_color.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF4F81BD"</span><span class="op">)</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span>creator <span class="op">=</span> <span class="st">"My name here"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"Expenditure"</span>, grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">USPersonalExpenditure</span>, row_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_border.html">wb_add_border</a></span><span class="op">(</span> <span class="co"># add the outer and inner border</span></span>
<span>    dims <span class="op">=</span> <span class="st">"A1:F6"</span>,</span>
<span>    top_border <span class="op">=</span> <span class="st">"thin"</span>, top_color <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    bottom_border <span class="op">=</span> <span class="st">"thin"</span>, bottom_color <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    inner_hgrid <span class="op">=</span> <span class="st">"thin"</span>, inner_hcolor <span class="op">=</span> <span class="va">border_color</span>,</span>
<span>    left_border <span class="op">=</span> <span class="st">""</span>, right_border <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_set_col_widths.html">wb_set_col_widths</a></span><span class="op">(</span> <span class="co"># set column width</span></span>
<span>    cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>    widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="co"># remove the value in A1</span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1"</span>, x <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p>Be aware that chains modify an object in place and pipes do not.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2</span></span>
<span><span class="va">wbp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">wbc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># need to assign wbp</span></span>
<span><span class="va">wbp</span> <span class="op">&lt;-</span> <span class="va">wbp</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span>
<span><span class="va">wbc</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">iris</span><span class="op">)</span></span></code></pre></div>
<p>You can re-use styles with <code><a href="../reference/cell_style.html">wb_get_cell_style()</a></code> and
<code><a href="../reference/cell_style.html">wb_set_cell_style()</a></code>. Abandoning <code>stylesObject</code>
in <code>openxlsx2</code> has the huge benefit that we can import and
export a spreadsheet without changing any cell style. It is still
possible to modify a cell style with <code><a href="../reference/wb_add_border.html">wb_add_border()</a></code>,
<code><a href="../reference/wb_add_fill.html">wb_add_fill()</a></code>, <code><a href="../reference/wb_add_font.html">wb_add_font()</a></code> and
<code><a href="../reference/wb_add_numfmt.html">wb_add_numfmt()</a></code>.</p>
<p>Additional examples regarding styles can be found in the styles
vignette.</p>
</div>
<div class="section level3">
<h3 id="conditional-formatting">Conditional formatting<a class="anchor" aria-label="anchor" href="#conditional-formatting"></a>
</h3>
<p>See <code><a href="../articles/conditional-formatting.html">vignette("conditional-formatting")</a></code> for extended
examples on formatting.</p>
<p>Here is a minimal example:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2 with chains</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_conditional_formatting</span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1:A4"</span>, rule <span class="op">=</span> <span class="st">"&gt;2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># openxlsx2 with pipes</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_conditional_formatting.html">wb_add_conditional_formatting</a></span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"A1:A4"</span>, rule <span class="op">=</span> <span class="st">"&gt;2"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="data-validation">Data validation<a class="anchor" aria-label="anchor" href="#data-validation"></a>
</h3>
<p>Similarly, data validation has been updated and improved. This
<code>openxlsx</code> code for data validation</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu">createWorkbook</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">addWorksheet</span><span class="op">(</span><span class="va">wb</span>, <span class="st">"Sheet 1"</span><span class="op">)</span></span>
<span><span class="fu">writeDataTable</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">dataValidation</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>,</span>
<span>  col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">31</span>, type <span class="op">=</span> <span class="st">"whole"</span>,</span>
<span>  operator <span class="op">=</span> <span class="st">"between"</span>, value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>looks in <code>openxlsx2</code> something like this:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># openxlsx2 with chains</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"Sheet 1"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data_table</span><span class="op">(</span><span class="fl">1</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data_validation</span><span class="op">(</span><span class="fl">1</span>,</span>
<span>    dims <span class="op">=</span> <span class="fu"><a href="../reference/wb_dims.html">wb_dims</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">31</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    <span class="co"># alternatively, dims can also be "A2:C31" if you know the span in your Excel workbook.</span></span>
<span>    type <span class="op">=</span> <span class="st">"whole"</span>,</span>
<span>    operator <span class="op">=</span> <span class="st">"between"</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># openxlsx2 with pipes</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="st">"Sheet 1"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data_table.html">wb_add_data_table</a></span><span class="op">(</span><span class="fl">1</span>, x <span class="op">=</span> <span class="va">iris</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data_validation.html">wb_add_data_validation</a></span><span class="op">(</span></span>
<span>    sheet <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    dims <span class="op">=</span> <span class="st">"A2:C31"</span>, <span class="co"># alternatively, dims = wb_dims(rows = 2:31, cols = 1:3)</span></span>
<span>    type <span class="op">=</span> <span class="st">"whole"</span>,</span>
<span>    operator <span class="op">=</span> <span class="st">"between"</span>,</span>
<span>    value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">9</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="saving">Saving<a class="anchor" aria-label="anchor" href="#saving"></a>
</h3>
<p>Saving has been switched from <code>saveWorbook()</code> to
<code><a href="../reference/wb_save.html">wb_save()</a></code> and opening a workbook has been switched from
<code>openXL()</code> to <code><a href="../reference/wb_open.html">wb_open()</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="invitation-to-contribute">Invitation to contribute<a class="anchor" aria-label="anchor" href="#invitation-to-contribute"></a>
</h2>
<p>We have put a lot of work into <code>openxls2</code> to make it
useful for our needs, improving what we found useful about
<code>openxlsx</code> and removing what we didn’t need. We do not claim
to be omniscient about all the things you can do with spreadsheet
software, nor do we claim to be omniscient about all the things you can
do in <code>openxlsx2</code>. The package is still under development and
we cannot make any promises about a stable API yet. This may change when
we reach version 1.0. Nevertheless, we are quite fond of our little
package and invite others to try it out and comment on what they like
and of course what they think we are missing or if something doesn’t
work. <code>openxlsx2</code> is a complex piece of software that
certainly does not work bug-free, even if we did our best. If you want
to contribute to the development of <code>openxlsx2</code>, please be
our guest on our Github. Join or open a discussion, post or fix issues
or write us a mail.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jordan Mark Barbone, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
