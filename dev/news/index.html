<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Changelog • openxlsx2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Changelog"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">openxlsx2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.11.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/openxlsx2.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/conditional-formatting.html">Add conditional formatting to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_charts_manual.html">Add charts to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_formulas_manual.html">Add formulas to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_read_to_df.html">openxlsx2 read to data frame manual</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_style_manual.html">Add styling to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/Update-from-openxlsx.html">Upgrade from openxlsx</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JanMarvin/openxlsx2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-news">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Changelog</h1>
      <small>Source: <a href="https://github.com/JanMarvin/openxlsx2/blob/main/NEWS.md" class="external-link"><code>NEWS.md</code></a></small>
    </div>

    <div class="section level2">
<h2 class="pkg-version" data-toc-text="development version" id="openxlsx2-development-version">openxlsx2 (development version)<a class="anchor" aria-label="anchor" href="#openxlsx2-development-version"></a></h2>
<div class="section level3">
<h3 id="new-features-development-version">New features<a class="anchor" aria-label="anchor" href="#new-features-development-version"></a></h3>
<ul><li>
<code><a href="../reference/properties-wb.html">wb_set_properties()</a></code> now has a <code>datetime_modify</code> option. <a href="https://github.com/JanMarvin/openxlsx2/pull/1176" class="external-link">1176</a>
</li>
<li>Make non consecutive equal sized dims behave similar to non equal sized non consecutive dims. This makes <code>dims = "A1:A5,C1:D5"</code> behave similar to <code>dims = "A1,C1:D1,A2:A5,C2:D5"</code>.</li>
<li>Improvements to the internal C++ code in <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code> to avoid string copies. <a href="https://github.com/JanMarvin/openxlsx2/pull/1184" class="external-link">1184</a> This is a continuation of work started in <a href="https://github.com/JanMarvin/openxlsx2/pull/1177" class="external-link">1177</a> to speedup <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code>/<code><a href="../reference/wb_add_data_table.html">wb_add_data_table()</a></code>.</li>
<li>Extend the <code>bookview</code> handling. It is now possible to add more than one <code>bookview</code> using <code>wb_set_bookview(view = 2L)</code> and to remove additional <code>bookview</code>s with <code><a href="../reference/wb_set_bookview.html">wb_remove_bookview()</a></code>. Available <code>bookview</code>s can be inspected with <code><a href="../reference/wb_set_bookview.html">wb_get_bookview()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1193" class="external-link">1193</a>
</li>
<li>Actually implement <code>sep</code> functionality in <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code> and <code><a href="../reference/wb_add_data_table.html">wb_add_data_table()</a></code> for list columns in <code>x</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1200" class="external-link">1200</a>
</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-development-version">Fixes<a class="anchor" aria-label="anchor" href="#fixes-development-version"></a></h3>
<ul><li>Create date is not reset to the present time in each call to <code><a href="../reference/properties-wb.html">wb_set_properties()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1176" class="external-link">1176</a>
</li>
<li>Improve handling of file headers and footers for a case where <code><a href="../reference/wb_load.html">wb_load()</a></code> would previously fail. <a href="https://github.com/JanMarvin/openxlsx2/pull/1186" class="external-link">1186</a>
</li>
<li>Partial labels were written only over the first element and only if assigned in an ordered fashion. <a href="https://github.com/JanMarvin/openxlsx2/pull/1189" class="external-link">1189</a>
</li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-development-version">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-development-version"></a></h3>
<ul><li>
<code><a href="../reference/wb_workbook.html">wb_workbook()</a></code> and the underlying <code>wbWorkbook</code> object gained a new argument <code>datetime_modified</code>. This argument was added after <code>datetime_created</code> and changes the number and ordering of arguments. <a href="https://github.com/JanMarvin/openxlsx2/pull/1176" class="external-link">1176</a>
</li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.11" id="openxlsx2-111">openxlsx2 1.11<a class="anchor" aria-label="anchor" href="#openxlsx2-111"></a></h2><p class="text-muted">CRAN release: 2024-11-14</p>
<div class="section level3">
<h3 id="new-features-1-11">New features<a class="anchor" aria-label="anchor" href="#new-features-1-11"></a></h3>
<ul><li>Add <code>hide_no_data_items</code> option in <code><a href="../reference/wb_add_slicer.html">wb_add_slicer()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1169" class="external-link">1169</a>
</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-11">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-11"></a></h3>
<ul><li>Previously rows that trigger scientific notation (e.g. <code>1e+05</code>) would cause issues, when matched against a non scientific version. <a href="https://github.com/JanMarvin/openxlsx2/pull/1170" class="external-link">1170</a>
</li>
<li>When using <code>wb_add_data_table(..., total_row = TRUE)</code> the last row of the data table in the workbook was mistakenly overwritten with the total row formula, which should have been placed below the last row of the table. This caused loss of data. <a href="https://github.com/JanMarvin/openxlsx2/issues/1179" class="external-link">1179</a>
</li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.10" id="openxlsx2-110">openxlsx2 1.10<a class="anchor" aria-label="anchor" href="#openxlsx2-110"></a></h2><p class="text-muted">CRAN release: 2024-10-17</p>
<div class="section level3">
<h3 id="new-features-1-10">New features<a class="anchor" aria-label="anchor" href="#new-features-1-10"></a></h3>
<ul><li><p>When writing a file with <code>na.strings = NULL</code>, the file will not contain any reference to the blank cell. Depending on the number of missings in a data set, this can reduce the file size significantly. <a href="https://github.com/JanMarvin/openxlsx2/pull/1111" class="external-link">1111</a></p></li>
<li><p><code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> gained a new argument <code>show_hyperlinks</code> which returns the target or location of a hyperlink, instead of the links description. <a href="https://github.com/JanMarvin/openxlsx2/pull/1136" class="external-link">1136</a></p></li>
<li><p>A new wrapper function <code><a href="../reference/wb_add_hyperlink.html">wb_add_hyperlink()</a></code> extends the capabilities of writing hyperlinks to shared hyperlinks. Shared hyperlinks bring along internal changes that are noted below. <a href="https://github.com/JanMarvin/openxlsx2/pull/1137" class="external-link">1137</a></p></li>
<li><p>Add <code>address</code> field to <code><a href="../reference/wb_add_image.html">wb_add_image()</a></code>. This can be used to add a url or mailto address to an image (<a href="https://github.com/JanMarvin/openxlsx2/pull/1138" class="external-link">1138</a>, conversion from a PR by <a href="https://github.com/jistria" class="external-link">@jistria</a> for <code>openxlsx</code>)</p></li>
<li><p>It is now possible to remove hyperlinks with either <code>wb_remove_hyperlinks()</code> or <code><a href="../reference/wb_clean_sheet.html">wb_clean_sheet()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1139" class="external-link">1139</a></p></li>
<li><p><code><a href="../reference/wb_add_data_table.html">wb_add_data_table()</a></code> will throw a warning if non distinct column names are found and will fix this for the user. Non distinct can be duplicated or even upper and lower case <code>x</code> and <code>X</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1150" class="external-link">1150</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-10">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-10"></a></h3>
<ul><li><p>The integration of the shared formula feature in the previous release broke the silent extension of dims, if a single cell <code>dims</code> was provided for an <code>x</code> that was larger than a single cell in <code><a href="../reference/wb_add_formula.html">wb_add_formula()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1131" class="external-link">1131</a></p></li>
<li><p>Fixed a regression in the previous release, where <code><a href="../reference/wb_dims.html">wb_dims()</a></code> would pass column names passed via <code>cols</code> to <code><a href="../reference/col2int.html">col2int()</a></code> which could cause overflow errors resulting in a failing check. <a href="https://github.com/JanMarvin/openxlsx2/pull/1133" class="external-link">1133</a></p></li>
<li><p>Fix cloning from worksheets with multiple images.</p></li>
<li><p>Improved <code>wb_to_df(types = ...)</code>. Previously if used on unordered data this could cause unintended class order. <code>types</code> no longer requires knowledge of the order of the variables. Not all variables must be specified and it accepts character classes as well. <a href="https://github.com/JanMarvin/openxlsx2/pull/1147" class="external-link">1147</a></p></li>
<li><p>Improve creation of table ids. Previously, on a dirty workbook, unique table ids were not enforced. This caused duplicated table ids, which lead to errors in spreadsheet software. <a href="https://github.com/JanMarvin/openxlsx2/pull/1152" class="external-link">1152</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-1-10">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-1-10"></a></h3>
<ul><li>The handling of shared hyperlinks has been updated. Previously, when loading a file with shared hyperlinks, they were converted into <code>wbHyperlink</code> objects (a legacy from <code>openxlsx</code>). With recent internal changes, hyperlinks are no longer automatically transformed into <code>wbHyperlink</code> objects. If you still require these objects, you can use the internal function <code>wb_to_hyperlink(wb, sheet = 1)</code>. However, please note that this class is not essential for <code>openxlsx2</code> and may be further simplified or removed in the future without notice. <a href="https://github.com/JanMarvin/openxlsx2/pull/1137" class="external-link">1137</a>
</li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.9" id="openxlsx2-19">openxlsx2 1.9<a class="anchor" aria-label="anchor" href="#openxlsx2-19"></a></h2><p class="text-muted">CRAN release: 2024-09-08</p>
<div class="section level3">
<h3 id="new-features-1-9">New features<a class="anchor" aria-label="anchor" href="#new-features-1-9"></a></h3>
<ul><li><p>Experimental support for shared formulas. Similar to spreadsheet software, when a cell is dragged to horizontally or vertically. This requires the formula to be written only for a single cell and it is filled by spreadsheet software for the remaining dimensions. <code><a href="../reference/wb_add_formula.html">wb_add_formula()</a></code> gained a new argument <code>shared</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1074" class="external-link">1074</a></p></li>
<li><p>Experimental support for reading shared formulas. If <code>show_formula</code> is used with <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code>, we try to show the value that is shown in spreadsheet software. <a href="https://github.com/JanMarvin/openxlsx2/pull/1091" class="external-link">1091</a></p></li>
<li><p>It is possible to read cells containing formulas as formula. <a href="https://github.com/JanMarvin/openxlsx2/pull/1103" class="external-link">1103</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-9">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-9"></a></h3>
<ul><li><p>If a font unknown to <code>openxlsx2</code> is used <code><a href="../reference/col_widths-wb.html">wb_set_col_widths()</a></code> defaults to using the workbooks default font. <a href="https://github.com/JanMarvin/openxlsx2/pull/1080" class="external-link">1080</a></p></li>
<li><p>Previously, if only <code>cols</code> and <code>rows</code> were passed to <code><a href="../reference/wb_dims.html">wb_dims()</a></code> and row <code>1</code> was selected, incorrect results were returned. This has been fixed. <a href="https://github.com/JanMarvin/openxlsx2/pull/1094" class="external-link">1094</a></p></li>
<li><p><code><a href="../reference/wb_dims.html">wb_dims()</a></code> no longer ignores <code>above</code>, <code>below</code>, <code>left</code>, <code>right</code> if <code>from_dims</code> is not supplied. <a href="https://github.com/JanMarvin/openxlsx2/pull/1104" class="external-link">1104</a></p></li>
<li><p><code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> with <code>skip_hidden_rows = TRUE</code> works now if a file path is passed. <a href="https://github.com/JanMarvin/openxlsx2/pull/1122" class="external-link">1122</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.8" id="openxlsx2-18">openxlsx2 1.8<a class="anchor" aria-label="anchor" href="#openxlsx2-18"></a></h2><p class="text-muted">CRAN release: 2024-07-07</p>
<div class="section level3">
<h3 id="maintenance-1-8">Maintenance<a class="anchor" aria-label="anchor" href="#maintenance-1-8"></a></h3>
<ul><li><p>Legacy <code><a href="../reference/write_data.html">write_data()</a></code>, <code><a href="../reference/write_datatable.html">write_datatable()</a></code>, <code><a href="../reference/write_formula.html">write_formula()</a></code>, <code><a href="../reference/comment_internal.html">write_comment()</a></code> are now deprecated in favor of <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code>, <code><a href="../reference/wb_add_data_table.html">wb_add_data_table()</a></code>, <code><a href="../reference/wb_add_formula.html">wb_add_formula()</a></code>, and <code><a href="../reference/wb_add_comment.html">wb_add_comment()</a></code>. (<a href="https://github.com/JanMarvin/openxlsx2/pull/1064" class="external-link">1064</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>).</p></li>
<li><p><code><a href="../reference/convertToExcelDate.html">convertToExcelDate()</a></code> is defunct and will be removed in a future version of the package. Use <code><a href="../reference/convert_to_excel_date.html">convert_to_excel_date()</a></code>. (<a href="https://github.com/JanMarvin/openxlsx2/pull/1064" class="external-link">1064</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>).</p></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-8">New features<a class="anchor" aria-label="anchor" href="#new-features-1-8"></a></h3>
<ul><li><p><code><a href="../reference/wb_dims.html">wb_dims()</a></code> is now able to handle various columns. <a href="https://github.com/JanMarvin/openxlsx2/pull/1019" class="external-link">1019</a></p></li>
<li><p><code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> now has a <code>check_names</code> argument. <a href="https://github.com/JanMarvin/openxlsx2/pull/1050" class="external-link">1050</a></p></li>
<li><p>The set of conditional formatting icon sets now includes x14 icons. This commit also fixed adding conditional formatting to worksheets with pivot tables. <a href="https://github.com/JanMarvin/openxlsx2/pull/1053" class="external-link">1053</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-8">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-8"></a></h3>
<ul><li><p>Many improvements in the <code>xlsb</code> parser. This includes changes to the logic of the formula parser, rich text strings are now handled, data validation, table formulas and various corrections all over the place. It is still lacking various features and this wont change in the foreseeable future, but the parser is now in better shape than ever. <a href="https://github.com/JanMarvin/openxlsx2/pull/1037" class="external-link">1037</a>, <a href="https://github.com/JanMarvin/openxlsx2/pull/1040" class="external-link">1040</a>, <a href="https://github.com/JanMarvin/openxlsx2/pull/1042" class="external-link">1042</a>, <a href="https://github.com/JanMarvin/openxlsx2/pull/1044" class="external-link">1044</a>, <a href="https://github.com/JanMarvin/openxlsx2/pull/1049" class="external-link">1049</a>, <a href="https://github.com/JanMarvin/openxlsx2/pull/1054" class="external-link">1054</a></p></li>
<li><p><code><a href="../reference/write_xlsx.html">write_xlsx()</a></code> now uses <code>sheet</code>. Previously it required the undocumented <code>sheet_name</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1057" class="external-link">1057</a></p></li>
<li><p>Fixed a bug were we obfuscated valid html in worksheets with vml buttons. These files previously did not load. <a href="https://github.com/JanMarvin/openxlsx2/pull/1062" class="external-link">1062</a></p></li>
<li><p>Fixed slow writing of non consecutive number formats introduced in the previous release. <a href="https://github.com/JanMarvin/openxlsx2/pull/1067" class="external-link">1067</a>, <a href="https://github.com/JanMarvin/openxlsx2/pull/1068" class="external-link">1068</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.7" id="openxlsx2-17">openxlsx2 1.7<a class="anchor" aria-label="anchor" href="#openxlsx2-17"></a></h2><p class="text-muted">CRAN release: 2024-06-02</p>
<div class="section level3">
<h3 id="new-features-1-7">New features<a class="anchor" aria-label="anchor" href="#new-features-1-7"></a></h3>
<ul><li><p>Add function to remove conditional formatting from worksheet <code><a href="../reference/wb_add_conditional_formatting.html">wb_remove_conditional_formatting()</a></code> <a href="https://github.com/JanMarvin/openxlsx2/pull/1011" class="external-link">1011</a></p></li>
<li><p>Silence a warning triggered by a folder called <code>"[trash]"</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1012" class="external-link">1012</a></p></li>
<li><p>Initial support for pivot table timelines. <a href="https://github.com/JanMarvin/openxlsx2/pull/1016" class="external-link">1016</a></p></li>
<li><p>Add <code><a href="../reference/wb_add_slicer.html">wb_add_timeline()</a></code> and extend <code><a href="../reference/wb_add_slicer.html">wb_add_slicer()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/1017" class="external-link">1017</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-7">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-7"></a></h3>
<ul><li><p>Fixed an issue with non consecutive dims, where columns or rows were silently dropped. <a href="https://github.com/JanMarvin/openxlsx2/pull/1015" class="external-link">1015</a></p></li>
<li><p>Fixes to <code><a href="../reference/wb_clone_worksheet.html">wb_clone_worksheet()</a></code> cloning drawings and images should be restored. <a href="https://github.com/JanMarvin/openxlsx2/pull/1016" class="external-link">1016</a></p></li>
<li><p>Fixed an issue where non consecutive columns with special types would overlap. If columns A and C were dates, column B would be formatted as date too. <a href="https://github.com/JanMarvin/openxlsx2/pull/1026" class="external-link">1026</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.6" id="openxlsx2-16">openxlsx2 1.6<a class="anchor" aria-label="anchor" href="#openxlsx2-16"></a></h2><p class="text-muted">CRAN release: 2024-05-01</p>
<div class="section level3">
<h3 id="new-features-1-6">New features<a class="anchor" aria-label="anchor" href="#new-features-1-6"></a></h3>
<ul><li><p>Helper to read sensitivity labels from files and apply them to workbooks. <a href="https://github.com/JanMarvin/openxlsx2/pull/983" class="external-link">983</a></p></li>
<li><p>It is now possible to pass non consecutive dims like <code>"A1:B1,C2:D2"</code> to various style helpers like <code><a href="../reference/wb_add_fill.html">wb_add_fill()</a></code>. In addition it is now possible to write a data set into a predefined dims region using <code>enforce = TRUE</code>. This handles either <code>","</code> or <code>";"</code> as cell separator. <a href="https://github.com/JanMarvin/openxlsx2/pull/993" class="external-link">993</a></p></li>
</ul><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># force a dataset into a specific cell dimension</span></span>
<span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>dims <span class="op">=</span> <span class="st">"I2:J2;A1:B2;G5:H6"</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span>, enforce <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fixes-1-6">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-6"></a></h3>
<ul><li><p>Allow writing data frames with zero rows. <a href="https://github.com/JanMarvin/openxlsx2/pull/987" class="external-link">987</a></p></li>
<li><p><code><a href="../reference/wb_dims.html">wb_dims()</a></code> has been improved and is safer on 0-length inputs. In particular, it will error for a case where a <code>cols</code> doesn’t exist in <code>x</code> (<a href="https://github.com/JanMarvin/openxlsx2/pull/990" class="external-link">990</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>).</p></li>
</ul><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Previously created a wrong dims</span></span>
<span><span class="fu"><a href="../reference/wb_dims.html">wb_dims</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span>, cols <span class="op">=</span> <span class="st">"non-existent-col"</span><span class="op">)</span></span>
<span><span class="co"># Now errors</span></span></code></pre></div>
<ul><li>
<code><a href="../reference/col_widths-wb.html">wb_set_col_widths()</a></code> is more strict about its arguments. If you provide <code>cols</code>, <code>widths</code>, or <code>hidden</code> don’t have appropriate length, it will throw a warning. This may change to an error in the future, so it is recommended to use appropriate values. (<a href="https://github.com/JanMarvin/openxlsx2/pull/991" class="external-link">991</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>).</li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.5" id="openxlsx2-15">openxlsx2 1.5<a class="anchor" aria-label="anchor" href="#openxlsx2-15"></a></h2><p class="text-muted">CRAN release: 2024-03-26</p>
<p>(This was updated post release.)</p>
<div class="section level3">
<h3 id="new-features-1-5">New features<a class="anchor" aria-label="anchor" href="#new-features-1-5"></a></h3>
<ul><li><p>It’s now possible to pass array formula vectors to <code><a href="../reference/wb_add_formula.html">wb_add_formula()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/958" class="external-link">958</a></p></li>
<li><p><code><a href="../reference/wb_add_data_table.html">wb_add_data_table()</a></code> gained a new <code>total_row</code> argument. This allows to add a total row to spreadsheets including text and spreadsheet formulas. <a href="https://github.com/JanMarvin/openxlsx2/pull/959" class="external-link">959</a></p></li>
<li><p><code><a href="../reference/wb_dims.html">wb_dims()</a></code> now accepts <code>from_dims</code> to specify a starting cell <a href="https://github.com/JanMarvin/openxlsx2/pull/960" class="external-link">960</a>.</p></li>
<li><p>You can now set <code>options(openxlsx2.na.strings)</code> to a value to have a default value for <code>na.strings</code> in <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code>, <code><a href="../reference/wb_add_data_table.html">wb_add_data_table()</a></code>, and <code><a href="../reference/write_xlsx.html">write_xlsx()</a></code> <a href="https://github.com/JanMarvin/openxlsx2/pull/968" class="external-link">968</a>.</p></li>
<li><p>The direction vectors are written is now controlled via <code>dims</code>. Previously it was required to transpose a vector to write it horizontally: <code>wb_add_data(x = t(letters), col_names = FALSE)</code>. Now the direction is defined by <code>dims</code>. The default is still to write vectors vertically, but for a horizontal vector it is possible to write <code>wb_add_data(x = letters, dims = "A1:Z1")</code>. This change impacts vectors, hyperlinks and formulas and basically everything that is not a two dimensional <code>x</code> object.</p></li>
</ul><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># before (workaround needed)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>dims <span class="op">=</span> <span class="fu"><a href="../reference/wb_dims.html">wb_dims</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co"># now (listens to dims)</span></span>
<span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>dims <span class="op">=</span> <span class="fu"><a href="../reference/wb_dims.html">wb_dims</a></span><span class="op">(</span>rows <span class="op">=</span> <span class="fl">1</span>, cols <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fixes-1-5">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-5"></a></h3>
<ul><li>Export <code><a href="../reference/wb_add_ignore_error.html">wb_add_ignore_error()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/955" class="external-link">955</a>
</li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.4" id="openxlsx2-14">openxlsx2 1.4<a class="anchor" aria-label="anchor" href="#openxlsx2-14"></a></h2><p class="text-muted">CRAN release: 2024-02-15</p>
<div class="section level3">
<h3 id="new-features-1-4">New features<a class="anchor" aria-label="anchor" href="#new-features-1-4"></a></h3>
<ul><li><p>Experimental support for calculation of pivot table fields. <a href="https://github.com/JanMarvin/openxlsx2/pull/892" class="external-link">892</a></p></li>
<li><p>Improve sparkline creation with new options and support snake case arguments. <a href="https://github.com/JanMarvin/openxlsx2/pull/920" class="external-link">920</a></p></li>
<li><p>Experimental support to get and set base colors. <a href="https://github.com/JanMarvin/openxlsx2/pull/938" class="external-link">938</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-4">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-4"></a></h3>
<ul><li><p>Character strings with XML content were not written correctly: <code>a &lt;br/&gt; b</code> was converted to something neither we nor spreadsheet software was able to decipher. <a href="https://github.com/JanMarvin/openxlsx2/pull/895" class="external-link">895</a></p></li>
<li><p>Restore <code>first_active_row</code>/<code>first_active_col</code> and <code>first_col</code>/<code>first_row</code> functionality in <code><a href="../reference/write_xlsx.html">write_xlsx()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/903" class="external-link">903</a></p></li>
<li><p>Further attempts to fix pivot table sorting. <a href="https://github.com/JanMarvin/openxlsx2/pull/912" class="external-link">912</a> In addition improve handling of non distinct names in <code><a href="../reference/wb_data.html">wb_data()</a></code> and add <code><a href="../reference/create_tablestyle.html">create_pivottablestyle()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/914" class="external-link">914</a></p></li>
<li><p>Document adding background color and images to comments and fix adding more than two images as background. <a href="https://github.com/JanMarvin/openxlsx2/pull/919" class="external-link">919</a></p></li>
<li><p>Improvements to <code><a href="../reference/base_font-wb.html">wb_set_base_font()</a></code>. This modifies the workbook theme now, including panose values. <a href="https://github.com/JanMarvin/openxlsx2/pull/935" class="external-link">935</a></p></li>
<li><p>Hyperlinks now use the color of the theme and the base size. <a href="https://github.com/JanMarvin/openxlsx2/pull/937" class="external-link">937</a></p></li>
<li><p><code><a href="../reference/wb_add_data.html">wb_add_data()</a></code> and <code><a href="../reference/wb_add_data_table.html">wb_add_data_table()</a></code> yield better error messages if attempting to add data to an empty workbook (<a href="https://github.com/JanMarvin/openxlsx2/pull/942" class="external-link">942</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>).</p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-1-4">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-1-4"></a></h3>
<ul><li>Updating to themes. This includes updates to the default style <code>'Office Theme'</code> <a href="https://github.com/JanMarvin/openxlsx2/pull/899" class="external-link">899</a>
<ul><li>This includes switching to the new default font <code>'Aptos Narrow'</code>
</li>
<li>A new style <code>'Office 2013 - 2022 Theme'</code> was added</li>
</ul>
Users that want to remain on the old style should use <code>wb_workbook(theme = 'Office 2013 - 2022 Theme')</code> or <code>wb_set_base_font(font_name = "Calibri")</code>.</li>
</ul></div>
<div class="section level3">
<h3 id="maintenance-1-4">Maintenance<a class="anchor" aria-label="anchor" href="#maintenance-1-4"></a></h3>
<ul><li><p>Code simplifications (<a href="https://github.com/JanMarvin/openxlsx2/pull/924" class="external-link">924</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>), partial matching (<a href="https://github.com/JanMarvin/openxlsx2/pull/923" class="external-link">923</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>)</p></li>
<li><p>Updates to test files and findings by various linters (<a href="https://github.com/JanMarvin/openxlsx2/pull/922" class="external-link">922</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>)</p></li>
<li><p>Improve <a href="https://janmarvin.github.io/openxlsx2/reference/wbWorkbook.html">wbWorkbook documentation</a> to help disambiguate the chaining and piping methods (<a href="https://github.com/JanMarvin/openxlsx2/pull/936" class="external-link">936</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a> and <a href="https://github.com/JanMarvin/openxlsx2/pull/928" class="external-link">928</a>).</p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.3" id="openxlsx2-13">openxlsx2 1.3<a class="anchor" aria-label="anchor" href="#openxlsx2-13"></a></h2><p class="text-muted">CRAN release: 2024-01-12</p>
<div class="section level3">
<h3 id="documentation-improvement-1-3">Documentation improvement<a class="anchor" aria-label="anchor" href="#documentation-improvement-1-3"></a></h3>
<ul><li>Further tweaks to documentation and vignettes to make them more consistent.
<ul><li>
<code><a href="../reference/wb_add_pivot_table.html">wb_add_pivot_table()</a></code> / <code><a href="../reference/wb_add_slicer.html">wb_add_slicer()</a></code>
</li>
<li>
<code><a href="../reference/wb_load.html">wb_load()</a></code>: <code>calc_chain</code> is no longer visible and the previous text that might have been misleading in regards of its use, has been replaced by a more detailed description of what are the consequences of keeping the calculation chain</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-3">New features<a class="anchor" aria-label="anchor" href="#new-features-1-3"></a></h3>
<ul><li><p>Allow further modifications of comments. The background can now be filled with a color or an image. <a href="https://github.com/JanMarvin/openxlsx2/pull/870" class="external-link">870</a></p></li>
<li><p>Added <code><a href="../reference/wb_cell_style.html">wb_set_cell_style_across()</a></code> to apply a cell style to selected columns and rows. This allows unlocking cells to make use column and row properties of <code><a href="../reference/wb_protect_worksheet.html">wb_protect_worksheet()</a></code> which require additional cell styles (see issue 871 for a more detailed explanation). <code><a href="../reference/wb_cell_style.html">wb_set_cell_style()</a></code> now accepts a cell dimension in the <code>style</code> argument. <a href="https://github.com/JanMarvin/openxlsx2/pull/873" class="external-link">873</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-3">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-3"></a></h3>
<ul><li><p><code><a href="../reference/wb_add_ignore_error.html">wb_add_ignore_error()</a></code> now returns a <code>wbWorkbook</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/865" class="external-link">865</a></p></li>
<li><p>Deactivate the <code>is_hyperlink</code> check for non-dataframe objects in <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code>. Internally, <code><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply()</a></code> is applied to the input object, which is applied column-wise for a data frame and cell-wise for a matrix. This speeds up the writing of larger matrices considerably. <a href="https://github.com/JanMarvin/openxlsx2/pull/876" class="external-link">876</a></p></li>
<li><p>Column style <code>currency</code> is now correctly applied to numeric vectors. Previously it was not handled. This applies the built in spreadsheet style for currency presumably linked to the spreadsheet software locale. <a href="https://github.com/JanMarvin/openxlsx2/pull/879" class="external-link">879</a></p></li>
<li><p><code>wb_to_df(col_names = FALSE)</code> no longer drops column names from logical vectors. Previously, column names were replaced by <code>NA</code>. Now the column name is returned as a cell value in a character column. <a href="https://github.com/JanMarvin/openxlsx2/pull/884" class="external-link">884</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.2" id="openxlsx2-12">openxlsx2 1.2<a class="anchor" aria-label="anchor" href="#openxlsx2-12"></a></h2><p class="text-muted">CRAN release: 2023-11-29</p>
<div class="section level3">
<h3 id="new-features-1-2">New features<a class="anchor" aria-label="anchor" href="#new-features-1-2"></a></h3>
<ul><li>Add new params to <code><a href="../reference/wb_add_pivot_table.html">wb_add_pivot_table()</a></code>. It is now possible to set the <code>show_data_as</code> value and set a tabular table design. <a href="https://github.com/JanMarvin/openxlsx2/pull/833" class="external-link">833</a>
</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-2">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-2"></a></h3>
<ul><li><p>Previously formulas written as data frames were not xml escaped. <a href="https://github.com/JanMarvin/openxlsx2/pull/834" class="external-link">834</a></p></li>
<li><p>Improve drawing relationship id selection that could cause issues with unordered relationship ids in loaded workbooks. <a href="https://github.com/JanMarvin/openxlsx2/pull/838" class="external-link">838</a></p></li>
<li><p>Improve copying cells in transpose mode and with hyperlinks. <a href="https://github.com/JanMarvin/openxlsx2/pull/850" class="external-link">850</a></p></li>
<li><p>Options <code>openxlsx2.maxWidth</code> and <code>openxlsx2.minWidth</code> are now respected as documented when setting column widths with <code><a href="../reference/col_widths-wb.html">wb_set_col_widths()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/issues/847" class="external-link">847</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.1" id="openxlsx2-11">openxlsx2 1.1<a class="anchor" aria-label="anchor" href="#openxlsx2-11"></a></h2><p class="text-muted">CRAN release: 2023-10-23</p>
<div class="section level3">
<h3 id="new-features-1-1">New features<a class="anchor" aria-label="anchor" href="#new-features-1-1"></a></h3>
<ul><li><p>Basic support for cloning worksheets across workbooks was added in <code><a href="../reference/wb_clone_worksheet.html">wb_clone_worksheet()</a></code>. This should work with tabular and formula data, images and charts. Support for more complex worksheets is known pending. <a href="https://github.com/JanMarvin/openxlsx2/pull/622" class="external-link">622</a></p></li>
<li><p>Enable loading workbooks without sheets with <code>wb_load(sheet = NULL)</code>. This is helpful if the sheets contain a lot of data and only some general workbook data is of interest. <a href="https://github.com/JanMarvin/openxlsx2/pull/810" class="external-link">810</a></p></li>
<li><p>It is no longer needed to manually create columns for <code><a href="../reference/grouping-wb.html">wb_group_cols()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/781" class="external-link">781</a></p></li>
<li><p>It is now possible to sort pivot tables created by <code><a href="../reference/wb_add_pivot_table.html">wb_add_pivot_table()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/795" class="external-link">795</a></p></li>
<li>
<p>Basic support for the <code>xlsb</code> file format. We parse the binary file format into pseudo-openxml files that we can import. Therefore, after importing, it is possible to interact with the file as if it had been provided as <code>xlsx</code> in the first place. This is of course slower than reading directly from the binary file. Our implementation is also still missing some features: some array formulas are still broken, conditional formatting and data validation are not implemented, nor are pivot tables and slicers. <a href="https://github.com/JanMarvin/openxlsx2/pull/688" class="external-link">688</a></p>
<ul><li>Please note that <code>openxlsx2</code> is not a security tool and the <code>xlsb</code> parser was written with the intention of reading valid <code>xlsb</code> files on little endian systems.</li>
<li>Please do not raise issues about <code>xlsb</code> in terms of speed or completeness of features of the openxml standard. If you have access to other file conversion tools, such as spreadsheet software, they may provide a better solution for your needs.</li>
<li>Writing <code>xlsb</code> files is outside the scope of this project.</li>
</ul></li>
<li><p>New set of function <code><a href="../reference/properties-wb.html">wb_get_properties()</a></code>/<code><a href="../reference/properties-wb.html">wb_set_properties()</a></code> to view and modify workbook properties. <a href="https://github.com/JanMarvin/openxlsx2/pull/782" class="external-link">782</a> This was subsequently improved to handle more workbook properties like <code>company</code> and <code>manager</code>. (<a href="https://github.com/JanMarvin/openxlsx2/pull/799" class="external-link">799</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>)</p></li>
<li><p>Basic (experimental) support to add slicers to pivot tables created by <code>openxlsx2</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/822" class="external-link">822</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-1">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-1"></a></h3>
<ul><li><p>Removing the worksheet that is the active tab does no longer result in warnings in spreadsheet software. <a href="https://github.com/JanMarvin/openxlsx2/pull/792" class="external-link">792</a></p></li>
<li><p><code>update_table()</code> works now without if the table has no <code>autofilter</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/802" class="external-link">802</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="1.0" id="openxlsx2-10">openxlsx2 1.0<a class="anchor" aria-label="anchor" href="#openxlsx2-10"></a></h2><p class="text-muted">CRAN release: 2023-08-25</p>
<div class="section level3">
<h3 id="breaking-changes-1-0">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-1-0"></a></h3>
<ul><li>
<code>wb_get_worksheet()</code>, <code>wb_ws()</code>, <code>wb_get_sheet_name()</code> are no longer exported. <a href="https://github.com/JanMarvin/openxlsx2/pull/735" class="external-link">735</a> They never worked as expected.
<ul><li>Use <code><a href="../reference/sheet_names-wb.html">wb_get_sheet_names()</a></code>, <code><a href="../reference/active_sheet-wb.html">wb_get_active_sheet()</a></code>, <code><a href="../reference/active_sheet-wb.html">wb_get_selected()</a></code> instead.</li>
</ul></li>
<li>
<code>wbChartSheet</code> is now internal (<a href="https://github.com/JanMarvin/openxlsx2/pull/760" class="external-link">760</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="deprecated-functions-1-0">Deprecated functions<a class="anchor" aria-label="anchor" href="#deprecated-functions-1-0"></a></h3>
<p>These functions are no longer recommended. A <a href="https://janmarvin.github.io/openxlsx2/dev/reference/openxlsx2-deprecated.html">guide</a> was created to help users They will continue to work for some time, but changing to newer functions is recommended.</p>
<ul><li>
<code><a href="../reference/delete_data.html">delete_data()</a></code> is deprecated in favor of <code><a href="../reference/wb_remove_tables.html">wb_remove_tables()</a></code> or <code><a href="../reference/wb_clean_sheet.html">wb_clean_sheet()</a></code>
</li>
<li>
<code><a href="../reference/create_comment.html">create_comment()</a></code> is deprecated in favor of <code><a href="../reference/wb_comment.html">wb_comment()</a></code>. Note that while <code><a href="../reference/wb_comment.html">wb_comment()</a></code> has some new defaults, the behavior of <code><a href="../reference/create_comment.html">create_comment()</a></code> has not changed. (<a href="https://github.com/JanMarvin/openxlsx2/pull/758" class="external-link">758</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>)</li>
</ul></div>
<div class="section level3">
<h3 id="new-features-1-0">New features<a class="anchor" aria-label="anchor" href="#new-features-1-0"></a></h3>
<ul><li>
<p><code><a href="../reference/wb_comment.html">wb_comment()</a></code> is a new helper function to help create <code>wbComment</code> objects It is very similar to <code><a href="../reference/create_comment.html">create_comment()</a></code>, with the following differences:</p>
<ul><li>
<code>author</code> looks at <code>options("openxlsx2.creator")</code>; (<code><a href="../reference/create_comment.html">create_comment()</a></code> only used <code>sys.getenv("USERNAME")</code> / <code>Sys.getenv("USER")</code>)</li>
<li>
<code>visible</code> defaults to <code>FALSE</code> to account for modern spreadsheet software behavior. (<code><a href="../reference/create_comment.html">create_comment()</a></code>, it is <code>TRUE</code>).</li>
<li>
<code>width</code> and <code>height</code> must now be of length 1. (In <code><a href="../reference/create_comment.html">create_comment()</a></code>, the first element is taken, other are ignored.)</li>
</ul></li>
<li><p><code><a href="../reference/sheet_names-wb.html">wb_get_sheet_names()</a></code> gains a <code>escape</code> argument to allow special XML characters to be escaped. <a href="https://github.com/JanMarvin/openxlsx2/issues/252" class="external-link">252</a></p></li>
<li><p><code><a href="../reference/wb_color.html">wb_color()</a></code> now accepts hex colors with leading sharp (e.g. “#FFFFF”) <a href="https://github.com/JanMarvin/openxlsx2/pull/728" class="external-link">728</a>.</p></li>
<li><p><code><a href="../reference/wb_merge_cells.html">wb_merge_cells()</a></code> gains a <code>solve</code> argument. This allows to solve cell intersecting regions. <a href="https://github.com/JanMarvin/openxlsx2/pull/733" class="external-link">733</a></p></li>
<li><p><code>wb_add_comment(comment = "x")</code> no longer errors when a comment as a character vector no longer fails (<a href="https://github.com/JanMarvin/openxlsx2/pull/758" class="external-link">758</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>)</p></li>
</ul></div>
<div class="section level3">
<h3 id="documentation-improvement-1-0">Documentation improvement<a class="anchor" aria-label="anchor" href="#documentation-improvement-1-0"></a></h3>
<ul><li>Tweaks to documentation and vignettes to make them more consistent.</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-1-0">Fixes<a class="anchor" aria-label="anchor" href="#fixes-1-0"></a></h3>
<ul><li>
<code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> now handles <code>date1904</code> detection. Previous results from this somewhat rare file type were using the default timezone origin of 1900-01-01. <a href="https://github.com/JanMarvin/openxlsx2/pull/737" class="external-link">737</a>
</li>
<li>
<code><a href="../reference/wb_load.html">wb_load()</a></code> handles more cases.
<ul><li>With workbooks with threaded comments <a href="https://github.com/JanMarvin/openxlsx2/issues/731" class="external-link">731</a>
</li>
<li>With workbooks with embeddings other than docx <a href="https://github.com/JanMarvin/openxlsx2/pulls/732" class="external-link">732</a>
</li>
<li>with workbooks with long hyperlinks <a href="https://github.com/JanMarvin/openxlsx2/issues/753" class="external-link">753</a>
</li>
</ul></li>
<li>
<code><a href="../reference/wb_load.html">wb_load()</a></code> adds the <code>path</code> to the <code>wbWorkbook</code> object. <a href="https://github.com/JanMarvin/openxlsx2/issues/741" class="external-link">741</a>
</li>
<li>
<code><a href="../reference/wb_set_header_footer.html">wb_set_header_footer()</a></code> now works with special characters <a href="https://github.com/JanMarvin/openxlsx2/issues/747" class="external-link">747</a>
</li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-1-0">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-1-0"></a></h3>
<ul><li>
<code><a href="../reference/active_sheet-wb.html">wb_get_active_sheet()</a></code>, <code><a href="../reference/active_sheet-wb.html">wb_set_active_sheet()</a></code>, <code><a href="../reference/active_sheet-wb.html">wb_get_selected()</a></code> and <code><a href="../reference/active_sheet-wb.html">wb_set_selected()</a></code>, <code><a href="../reference/named_region-wb.html">wb_get_named_regions()</a></code> are now wrapper functions. <a href="https://github.com/JanMarvin/openxlsx2/pull/735" class="external-link">735</a>
</li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.8" id="openxlsx2-08">openxlsx2 0.8<a class="anchor" aria-label="anchor" href="#openxlsx2-08"></a></h2><p class="text-muted">CRAN release: 2023-08-07</p>
<div class="section level3">
<h3 id="api-change-0-8">API Change<a class="anchor" aria-label="anchor" href="#api-change-0-8"></a></h3>
<ul><li><p>Function arguments are now defaulting to <code>snake_case</code>. For the time being, both arguments are accepted and <code>camelCase</code> will be switched to <code>snake_case</code> under the hood. Some examples are currently still displaying <code>camelCase</code> and maybe some <code>camelCase</code> function slipped through. <a href="https://github.com/JanMarvin/openxlsx2/pull/678" class="external-link">678</a></p></li>
<li>
<p><code><a href="../reference/write_formula.html">write_formula()</a></code>, <code><a href="../reference/write_data.html">write_data()</a></code>, <code><a href="../reference/write_datatable.html">write_datatable()</a></code>, <code><a href="../reference/comment_internal.html">write_comment()</a></code> are no longer recommended,</p>
<ul><li>Use <code><a href="../reference/wb_add_formula.html">wb_add_formula()</a></code>, <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code>, <code><a href="../reference/wb_add_data_table.html">wb_add_data_table()</a></code>, <code><a href="../reference/wb_add_comment.html">wb_add_comment()</a></code> instead.</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-8">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-8"></a></h3>
<ul><li><p>Order of arguments in <code><a href="../reference/named_region-wb.html">wb_add_named_region()</a></code> changed, because previously overlooked <code>dims</code> argument was added.</p></li>
<li><p>In various functions the order of <code>dims</code> was changed, to highlight it’s importance</p></li>
<li>
<p>Cleanups</p>
<ul><li><p>remove deprecated functions</p></li>
<li>
<p>remove deprecated arguments</p>
<ul><li>
<code>xy</code> argument</li>
<li>arguments <code>col</code>, <code>row</code>, <code>cols</code>, <code>rows</code>. <code>start_col</code>, <code>start_row</code> and <code>gridExpand</code> were deprecated in favor of <code>dims</code>. Row and column vectors can be converted to <code>dims</code> using <code><a href="../reference/wb_dims.html">wb_dims()</a></code>.</li>
<li>
<code>xlsx_file</code> in favor of <code>file</code> in <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code>
</li>
</ul></li>
<li>
<p>deprecating function</p>
<ul><li>
<code><a href="../reference/convertToExcelDate.html">convertToExcelDate()</a></code> for <code><a href="../reference/convert_to_excel_date.html">convert_to_excel_date()</a></code>
</li>
<li>
<code><a href="../reference/wb_set_grid_lines.html">wb_grid_lines()</a></code> for <code><a href="../reference/wb_set_grid_lines.html">wb_set_grid_lines()</a></code>
</li>
</ul></li>
<li><p>make <code>get_cell_refs()</code>, <code>get_date_origin()</code>, <code>guess_col_type()</code>, and <code>write_file()</code>, <code><a href="../reference/dataframe_to_dims.html">dataframe_to_dims()</a></code>, <code><a href="../reference/dims_to_dataframe.html">dims_to_dataframe()</a></code>, <code>wb_get_sheet_name()</code> internal functions</p></li>
<li><p>make classes <code>styles_mgr()</code>, <code>wbSheetData</code>, <code>wbWorksheet</code>, <code>wbComment</code>, <code>wbHyperlink</code> internal</p></li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="new-features-0-8">New features<a class="anchor" aria-label="anchor" href="#new-features-0-8"></a></h3>
<ul><li>
<code><a href="../reference/wb_dims.html">wb_dims()</a></code> was added as a more convenient replacement for <code><a href="../reference/dims_helper.html">rowcol_to_dims()</a></code>.(<a href="https://github.com/JanMarvin/openxlsx2/pull/691" class="external-link">691</a> and <a href="https://github.com/JanMarvin/openxlsx2/pull/702" class="external-link">702</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>) The new function can take either numeric (for rows or columns) or character (column) vectors, in addition it is able to create dimensions for R objects that are coercible to data frame. This allows the following variants:
<ul><li><code>wb_dims(1:5, letters)</code></li>
<li><code>wb_dims(1:5, 1:26)</code></li>
<li><code>wb_dims(x = matrix(1, 5, 26))</code></li>
<li><code>wb_dims(x = mtcars, from_col = "C", from_row = 2, row_names = TRUE)</code></li>
</ul></li>
<li>Handling of thread comments is now possible via <code><a href="../reference/wb_add_thread.html">wb_add_thread()</a></code>. This includes options to reply and resolve comments.</li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-8">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-8"></a></h3>
<ul><li>Improve <code>show_formula</code>. Previously it was called to early in the function and skipped a few cases. <a href="https://github.com/JanMarvin/openxlsx2/pull/715" class="external-link">715</a>
</li>
</ul></div>
<div class="section level3">
<h3 id="refactoring-0-8">Refactoring<a class="anchor" aria-label="anchor" href="#refactoring-0-8"></a></h3>
<ul><li><p>Cleanup / revisit documentation and vignettes (<a href="https://github.com/JanMarvin/openxlsx2/pull/682" class="external-link">682</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>)</p></li>
<li><p>The <a href="https://janmarvin.github.io/openxlsx2/reference/">function index</a> has been improved. (<a href="https://github.com/JanMarvin/openxlsx2/pull/717" class="external-link">717</a>, <a href="https://github.com/olivroy" class="external-link">@olivroy</a>)</p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7.1" id="openxlsx2-071">openxlsx2 0.7.1<a class="anchor" aria-label="anchor" href="#openxlsx2-071"></a></h2><p class="text-muted">CRAN release: 2023-06-30</p>
<div class="section level3">
<h3 id="new-features-0-7-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-7-1"></a></h3>
<ul><li><p>It is now possible to apply a specific theme to a workbook. <a href="https://github.com/JanMarvin/openxlsx2/pull/630" class="external-link">630</a></p></li>
<li><p>Removed a few of the former example files and updated the code to use a new default example. This changes internal testing to only run locally if online and external files are required. This reduces the package footprint a little, because 1MB of xlsx files are now excluded. <a href="https://github.com/JanMarvin/openxlsx2/pull/632" class="external-link">632</a></p></li>
<li><p>The handling of <code><a href="../reference/fmt_txt.html">fmt_txt()</a></code> objects has been improved. It now creates objects of class <code>fmt_txt</code> with their own <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>, <code>+</code>, and <code><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character()</a></code> methods. Such objects can now also be used as <code>text</code> in <code><a href="../reference/create_comment.html">create_comment()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/636" class="external-link">636</a></p></li>
<li><p>Improve support for inputs with <code>labels</code> attribute. If e.g. a <code>factor</code> label is numeric, we now try to write the label as number. This should impact the way other partially labeled variables are written. <a href="https://github.com/JanMarvin/openxlsx2/pull/639" class="external-link">639</a></p></li>
<li><p>Added new wrapper function <code><a href="../reference/wb_add_named_style.html">wb_add_named_style()</a></code> this supports pre-defined theme aware cell styles like <code>Title</code> or <code>Note</code>. In addition loading of cell styles was improved and additional custom cell styles should be available as well. <a href="https://github.com/JanMarvin/openxlsx2/pull/628" class="external-link">628</a></p></li>
<li><p>Provide additional options to write special characters in non-unicode environments. <a href="https://github.com/JanMarvin/openxlsx2/pull/641" class="external-link">641</a></p></li>
<li><p>Add <code><a href="../reference/wb_add_dxfs_style.html">wb_add_dxfs_style()</a></code> as single line wrapper to create dxf styles used in conditional formatting and custom table styles. <a href="https://github.com/JanMarvin/openxlsx2/pull/665" class="external-link">665</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-7-1">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-7-1"></a></h3>
<ul><li><p>On load <code>app.xml</code> is now assigned to <code>wb$app</code>. Previously it was loaded but not assigned. <a href="https://github.com/JanMarvin/openxlsx2/pull/629" class="external-link">629</a></p></li>
<li><p>Previously if <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> was used with argument <code>cols</code>, columns that were missing were created at the end of the output frame. Now columns are returned ordered. <a href="https://github.com/JanMarvin/openxlsx2/pull/631" class="external-link">631</a></p></li>
<li><p>Fix a bug in <code><a href="../reference/wb_load.html">wb_load()</a></code> that was modifying the cell range of conditional formatting. <a href="https://github.com/JanMarvin/openxlsx2/pull/647" class="external-link">647</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-7-1">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-7-1"></a></h3>
<ul><li><p>Order of arguments in <code><a href="../reference/wb_add_conditional_formatting.html">wb_add_conditional_formatting()</a></code> changed, because previously overlooked <code>dims</code> argument was added. <a href="https://github.com/JanMarvin/openxlsx2/pull/642" class="external-link">642</a></p></li>
<li><p>New argument <code>gradientFill</code> was added to <code><a href="../reference/create_dxfs_style.html">create_dxfs_style()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/651" class="external-link">651</a></p></li>
<li><p>Special characters are now escaped in conditional formatting. Hence, previously manually escaped conditional formatting needs updates. <a href="https://github.com/JanMarvin/openxlsx2/pull/666" class="external-link">666</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.7" id="openxlsx2-07">openxlsx2 0.7<a class="anchor" aria-label="anchor" href="#openxlsx2-07"></a></h2><p class="text-muted">CRAN release: 2023-05-26</p>
<div class="section level3">
<h3 id="new-features-0-7">New features<a class="anchor" aria-label="anchor" href="#new-features-0-7"></a></h3>
<ul><li><p>The <code>dims</code> argument of <code><a href="../reference/wb_add_formula.html">wb_add_formula()</a></code> can be used to create a array references. A new <code>cm</code> argument was added which might be useful, if formulas previously created addition <code>@</code> in spreadsheet software. Examples how to use formulas were added to a new vignette. <a href="https://github.com/JanMarvin/openxlsx2/pull/593" class="external-link">593</a></p></li>
<li><p>Allow using custom data table styles. This fixes a few minor style inconsistencies. <a href="https://github.com/JanMarvin/openxlsx2/pull/594" class="external-link">594</a></p></li>
<li><p>Allow reading and writing <code>hms</code> columns. <a href="https://github.com/JanMarvin/openxlsx2/pull/601" class="external-link">601</a></p></li>
<li><p>Import <code>tableStyles</code> with <code><a href="../reference/wb_load.html">wb_load()</a></code> and improve <code>dxf</code> style creation. <a href="https://github.com/JanMarvin/openxlsx2/pull/603" class="external-link">603</a></p></li>
<li><p>Add <code><a href="../reference/fmt_txt.html">fmt_txt()</a></code> to style character strings. <a href="https://github.com/JanMarvin/openxlsx2/pull/607" class="external-link">607</a></p></li>
<li><p>Add new wrapper to ignore worksheet errors <code><a href="../reference/wb_add_ignore_error.html">wb_add_ignore_error()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/617" class="external-link">617</a></p></li>
<li><p>Add new wrapper to update table references <code><a href="../reference/wb_update_table.html">wb_update_table()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/606" class="external-link">606</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-7">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-7"></a></h3>
<ul><li><p>Improve handling of non standard <code>OutDec</code> options. <a href="https://github.com/JanMarvin/openxlsx2/pull/611" class="external-link">611</a></p></li>
<li><p><code>openxlsx2</code> now does a better job of trying to return <code>character</code> values from classes that are foreign to it. This has been going on for quite some time, although previously we had a bug that treated such classes as <code>numeric</code>, resulting in corrupted xlsx files. <a href="https://github.com/JanMarvin/openxlsx2/pull/615" class="external-link">615</a></p></li>
<li><p>We now return a few additional xml arguments from worksheets. <a href="https://github.com/JanMarvin/openxlsx2/pull/617" class="external-link">617</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.6.1" id="openxlsx2-061">openxlsx2 0.6.1<a class="anchor" aria-label="anchor" href="#openxlsx2-061"></a></h2><p class="text-muted">CRAN release: 2023-04-21</p>
<div class="section level3">
<h3 id="new-features-0-6-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-6-1"></a></h3>
<ul><li><p>Improve <code><a href="../reference/col2int.html">col2int()</a></code> to accept column ranges like <code>col2int("A:Z")</code>. This should allow using column ranges in various places like <code>wb_merge_cells(cols = "B:D", ...)</code> or <code>wb_read(cols = c("A","C:D"))</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/575" class="external-link">575</a></p></li>
<li><p>Add <code>dims</code> argument to <code><a href="../reference/wb_add_image.html">wb_add_image()</a></code> and <code><a href="../reference/wb_add_plot.html">wb_add_plot()</a></code>. This can be used to place images starting at a cell or span a cell range. This deprecates <code>xy</code> in <code><a href="../reference/wb_add_plot.html">wb_add_plot()</a></code>. This adds colOffset and rowOffset to <code><a href="../reference/wb_add_drawing.html">wb_add_drawing()</a></code> and <code><a href="../reference/wb_add_mschart.html">wb_add_mschart()</a></code> and <code><a href="../reference/wb_add_chart_xml.html">wb_add_chart_xml()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/578" class="external-link">578</a></p></li>
<li><p>Add <code>skipHiddenCols</code> and <code>skipHiddenRows</code> to <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code>. In this way, hidden columns and rows are ignored, assuming that the person who has hidden them assumes that they are not important. <a href="https://github.com/JanMarvin/openxlsx2/pull/579" class="external-link">579</a></p></li>
<li><p>When writing <code>tibble</code> use <code>to.data.frame()</code> just like in the <code>data.table</code> case. <a href="https://github.com/JanMarvin/openxlsx2/pull/582" class="external-link">582</a></p></li>
<li><p>Add cleanup internal comment code in <code><a href="../reference/comment_internal.html">write_comment()</a></code>. This should not impact the workbook wrapper code in <code><a href="../reference/wb_add_comment.html">wb_add_comment()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/586" class="external-link">586</a></p></li>
<li><p>Added chain functions for <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> and <code><a href="../reference/wb_load.html">wb_load()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/587" class="external-link">587</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.6" id="openxlsx2-06">openxlsx2 0.6<a class="anchor" aria-label="anchor" href="#openxlsx2-06"></a></h2><p class="text-muted">CRAN release: 2023-04-02</p>
<div class="section level3">
<h3 id="new-features-0-6">New features<a class="anchor" aria-label="anchor" href="#new-features-0-6"></a></h3>
<ul><li><p>Styles arguments now accept logical and numeric arguments where applicable. <a href="https://github.com/JanMarvin/openxlsx2/pull/558" class="external-link">558</a></p></li>
<li><p>Adding <code>dims</code> argument to <code><a href="../reference/wb_clean_sheet.html">wb_clean_sheet()</a></code>. This allows to clean only a selected range. <a href="https://github.com/JanMarvin/openxlsx2/pull/563" class="external-link">563</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-6">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-6"></a></h3>
<ul><li><p><code>na.strings = NULL</code> is no longer ignored in <code><a href="../reference/write_xlsx.html">write_xlsx()</a></code> <a href="https://github.com/JanMarvin/openxlsx2/issues/552" class="external-link">552</a></p></li>
<li><p>Explicit type conversion to date and datetime is finally available. <a href="https://github.com/JanMarvin/openxlsx2/pull/551" class="external-link">551</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-6">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-6"></a></h3>
<ul><li><p><code>skipEmptyCols</code> and <code>skipEmptyRows</code> behavior in <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> related functions was switched to include empty columns that have a name. Previously we would exclude columns if they were empty, even if they had a name. <a href="https://github.com/JanMarvin/openxlsx2/pull/555" class="external-link">555</a></p></li>
<li>
<p>Cleanups in <a href="https://github.com/JanMarvin/openxlsx2/pull/548" class="external-link">548</a></p>
<ul><li>remove deprecated functions
<ul><li><code>cloneSheetStyle()</code></li>
<li><code>get_cell_style()</code></li>
<li><code>set_cell_style()</code></li>
<li><code>wb_conditional_formatting()</code></li>
</ul></li>
<li>remove deprecated arguments
<ul><li>
<code>xy</code> argument for <code>write_data_table()</code> interacting functions</li>
<li>
<code>file</code> from <code><a href="../reference/xl_open.html">xl_open()</a></code>
</li>
<li>
<code>definedName</code> from <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> interacting functions</li>
</ul></li>
<li>deprecating function
<ul><li>
<code>get_named_regions()</code> for <code><a href="../reference/named_region-wb.html">wb_get_named_regions()</a></code>
</li>
</ul></li>
</ul></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.5.1" id="openxlsx2-051">openxlsx2 0.5.1<a class="anchor" aria-label="anchor" href="#openxlsx2-051"></a></h2><p class="text-muted">CRAN release: 2023-02-26</p>
<div class="section level3">
<h3 id="new-features-0-5-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-5-1"></a></h3>
<ul><li><p>Allow hierarchical grouping. <code>wb_group_cols</code>/<code>wb_group_rows</code> now accept nested lists as grouping variable. <a href="https://github.com/JanMarvin/openxlsx2/pull/537" class="external-link">537</a></p></li>
<li><p>It is now possible to add form control types <code>Checkbox</code>, <code>Radio</code> and <code>Drop</code> to a workbook using <code><a href="../reference/wb_add_form_control.html">wb_add_form_control()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/533" class="external-link">533</a></p></li>
<li><p>Improve <code>wb_to_df(fillMergedCells = TRUE)</code> to work better with dimensions. It is now possible to fill cells where the merged cells intersect with the selected dimensions. <a href="https://github.com/JanMarvin/openxlsx2/pull/541" class="external-link">541</a></p></li>
<li><p>Speedup cell initialization. This is used in wb_style functions like <code><a href="../reference/wb_add_numfmt.html">wb_add_numfmt()</a></code>. The previous loop was replaced with a faster implementation. <a href="https://github.com/JanMarvin/openxlsx2/pull/545" class="external-link">545</a></p></li>
<li><p>Improve date detection in <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code>. This improves date and posix detection with custom date formats. <a href="https://github.com/JanMarvin/openxlsx2/pull/547" class="external-link">547</a></p></li>
<li><p><code><a href="../reference/waivers.html">na_strings()</a></code> is now used as the explicit default value for <code>na.strings</code> parameters in exported workbook functions. <a href="https://github.com/JanMarvin/openxlsx2/issues/473" class="external-link">473</a></p></li>
<li><p>waiver functions (i.e., <code>next_worksheet()</code>, <code>current_worksheet()</code>, and <code><a href="../reference/waivers.html">na_strings()</a></code>) are now exports <a href="https://github.com/JanMarvin/openxlsx2/issues/474" class="external-link">474</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-5-1">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-5-1"></a></h3>
<ul><li><p>Fixed a bug when loading input with multiple sheets where not every sheet contains a drawing/comment. Previously we assumed that every sheet had a comment and ordered them incorrectly. This caused confusion in spreadsheet software. <a href="https://github.com/JanMarvin/openxlsx2/pull/536" class="external-link">536</a></p></li>
<li><p>Fixed a bug with files containing 10 or more external references. In this case we did not load the references in numeric order and instead as “1.xml”, “10.xml”, …, “2.xml”, … This jumbled up the external references. <a href="https://github.com/JanMarvin/openxlsx2/pull/538" class="external-link">538</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.5" id="openxlsx2-05">openxlsx2 0.5<a class="anchor" aria-label="anchor" href="#openxlsx2-05"></a></h2><p class="text-muted">CRAN release: 2023-01-29</p>
<div class="section level3">
<h3 id="new-features-0-5">New features<a class="anchor" aria-label="anchor" href="#new-features-0-5"></a></h3>
<ul><li><p>Improve column and row grouping. It is now possible to group by list, so that you can create various levels of groupings. <a href="https://github.com/JanMarvin/openxlsx2/pull/486" class="external-link">486</a></p></li>
<li><p><code>writeData()</code> calls <code>force(x)</code> to evaluate the object before options are set (<a href="https://github.com/ycphs/openxlsx/issues/264" class="external-link">#264</a>)</p></li>
<li><p><code>tabColor</code> in <code><a href="../reference/wb_add_worksheet.html">wb_add_worksheet()</a></code> now allows passing <code><a href="../reference/wb_color.html">wb_color()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/500" class="external-link">500</a></p></li>
<li><p>Add <code><a href="../reference/wb_copy_cells.html">wb_copy_cells()</a></code> a wrapper that allows copying cell ranges in a workbook as direct copy, as reference or as value. <a href="https://github.com/JanMarvin/openxlsx2/pull/515" class="external-link">515</a></p></li>
<li>
<p>Experimental option: <code>openxlsx2.string_nums</code> to write string numerics differently. A string numeric is a numeric in a string like: <code>as.character(1.5)</code>. The option can be</p>
<ul><li>0 = the current default. Writes string numeric as string (the incorrect way according to spreadsheet software)</li>
<li>1 = writes string numeric as numeric with a character flag (the correct way according to spreadsheet software)</li>
<li>2 = convert all string numeric to numeric when writing</li>
</ul><p>This is experimental, because the impact is somewhat unknown. It might trigger unintended side effects. Feedback is requested.</p>
</li>
<li><p>Enable writing strings as <code>sharedStrings</code> with argument <code>inline_strings = FALSE</code>. This creates a <code>sharedStrings</code> table in openxml that allows to reuse strings in the workbook efficiently and can reduce the file size if a workbook has many cells that are duplicates. <a href="https://github.com/JanMarvin/openxlsx2/pull/499" class="external-link">499</a></p></li>
<li><p>Initial implementation of <code><a href="../reference/wb_add_pivot_table.html">wb_add_pivot_table()</a></code>. This allows adding native pivot tables to <code>openxlsx2</code> workbooks. The pivot table area will remain empty until the sheet is opened in spreadsheet software and evaluated successfully. This feature is newly developed and can cause unexpected side effects. Be aware that using it might currently break workbooks.</p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-5">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-5"></a></h3>
<ul><li><p>Reading of files with frozen panes and more than one section node was restored. <a href="https://github.com/JanMarvin/openxlsx2/pull/495" class="external-link">495</a></p></li>
<li><p>Fixed a copy and paste mistake in <code>add_border()</code> which used left borders for right borders. <a href="https://github.com/JanMarvin/openxlsx2/pull/496" class="external-link">496</a></p></li>
<li><p>Improve XML unescaping. <a href="https://github.com/JanMarvin/openxlsx2/pull/497" class="external-link">497</a></p></li>
<li><p>Fix reading and saving workbooks with multiple slicers per sheet. <a href="https://github.com/JanMarvin/openxlsx2/pull/505" class="external-link">505</a></p></li>
<li><p>Fix tab selection always selecting the first sheet since <a href="https://github.com/JanMarvin/openxlsx2/issues/303" class="external-link">#303</a>. <a href="https://github.com/JanMarvin/openxlsx2/pull/506" class="external-link">506</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-5">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-5"></a></h3>
<ul><li><p>Do not export <code>write_data2()</code> anymore. This was used in development in the early stages of the package and should not be used directly anymore.</p></li>
<li><p>Only documentation: <code>openxlsx2</code> defaults to American English ‘color’ from now on. Though, we fully support the previous ‘colour’. Users will not have to adjust their code. Our documentation only lists <code>color</code>, but you can pass <code>colour</code> just the same way you used to. <a href="https://github.com/JanMarvin/openxlsx2/pull/501" class="external-link">501</a> <a href="https://github.com/JanMarvin/openxlsx2/pull/502" class="external-link">502</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.4.1" id="openxlsx2-041">openxlsx2 0.4.1<a class="anchor" aria-label="anchor" href="#openxlsx2-041"></a></h2><p class="text-muted">CRAN release: 2022-12-18</p>
<div class="section level3">
<h3 id="new-features-0-4-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-4-1"></a></h3>
<ul><li><p>Provide new argument <code>calc_chain</code> to <code><a href="../reference/wb_load.html">wb_load()</a></code>. This is set to <code>FALSE</code> per default, to ignore the calculation chain if it is found. This change only reflects files imported from third party spreadsheet software and should not be visible to the user. <a href="https://github.com/JanMarvin/openxlsx2/pull/461" class="external-link">461</a></p></li>
<li><p>Tweaks to <code><a href="../reference/wb_data.html">wb_data()</a></code>. Dims is now optional and will select data similar to <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code>, similar it allows passing down other <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code> arguments. Though, it probably is a good idea not be to creative passing down arguments, not all will result in a usable <code>wb_data</code> object. <a href="https://github.com/JanMarvin/openxlsx2/pull/462" class="external-link">462</a></p></li>
<li><p>Add <code>hidden</code> argument and change the default for <code>heights</code> to <code>NULL</code> in <code>set_row_heights()</code>. This allows changing the row height and/or hiding selected rows. This does not yet provide a way to hide rows per default. <a href="https://github.com/JanMarvin/openxlsx2/pull/475" class="external-link">475</a></p></li>
<li><p>Add <code><a href="../reference/wb_add_chartsheet.html">wb_add_chartsheet()</a></code> for chart sheet support. Along with internal cleanup around chart sheet code. <a href="https://github.com/JanMarvin/openxlsx2/pull/466" class="external-link">466</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-4-1">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-4-1"></a></h3>
<ul><li><p>Fix <code><a href="../reference/wb_freeze_pane.html">wb_freeze_pane()</a></code>. This changes the load logic a bit. Previously we put everything into <code>sheetViews</code> (the frozen pane is part of this). Though <code><a href="../reference/wb_freeze_pane.html">wb_freeze_pane()</a></code> assumes that <code>freezePane</code> is used. We now try to be smart and split sheetViews upon loading. <a href="https://github.com/JanMarvin/openxlsx2/pull/465" class="external-link">465</a></p></li>
<li><p>Previously, adding mschart objects to sheets was only possible if (1) the worksheet already contained a drawing (if the workbook was loaded) or (2) to the last sheet of the workbook. This has now been fixed. Adding mschart objects to any worksheet in the workbook is now possible as intended. <a href="https://github.com/JanMarvin/openxlsx2/pull/458" class="external-link">458</a></p></li>
<li><p>Really fix double xml escaping when saving. <a href="https://github.com/JanMarvin/openxlsx2/pull/467" class="external-link">467</a></p></li>
<li><p>Improving the drawing logic. There are some workbooks with various drawings per sheet and previously there were combinations possible that were not reflecting this. <a href="https://github.com/JanMarvin/openxlsx2/pull/478" class="external-link">478</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.4" id="openxlsx2-04">openxlsx2 0.4<a class="anchor" aria-label="anchor" href="#openxlsx2-04"></a></h2><p class="text-muted">CRAN release: 2022-12-05</p>
<div class="section level3">
<h3 id="new-features-0-4">New features<a class="anchor" aria-label="anchor" href="#new-features-0-4"></a></h3>
<ul><li><p>Provide <code>rvg</code> support via <code><a href="../reference/wb_add_drawing.html">wb_add_drawing()</a></code>. This allows integrating <code>rvg</code> plots into xlsx files. <a href="https://github.com/JanMarvin/openxlsx2/pull/449" class="external-link">449</a></p></li>
<li><p>Improve print options. Defaults to printing grid lines, if the worksheet contains grid lines. <a href="https://github.com/JanMarvin/openxlsx2/pull/440" class="external-link">440</a></p></li>
<li><p>Support reading files with form control. <a href="https://github.com/JanMarvin/openxlsx2/pull/426" class="external-link">426</a></p></li>
<li><p>Handle input files with chart extensions. <a href="https://github.com/JanMarvin/openxlsx2/pull/443" class="external-link">443</a></p></li>
<li><p>Improve writing styles to workbook. Previously every cell was checked, this has been changed to check unique styles. <a href="https://github.com/JanMarvin/openxlsx2/pull/423" class="external-link">423</a></p></li>
<li><p>Implement reading custom file properties. <a href="https://github.com/JanMarvin/openxlsx2/pull/418" class="external-link">418</a></p></li>
<li><p>Improved <code>add_named_region()</code>. This function includes now various xml options. <a href="https://github.com/JanMarvin/openxlsx2/pull/386" class="external-link">386</a></p></li>
<li><p>Add … as argument to <code><a href="../reference/wb_to_df.html">read_xlsx()</a></code> and <code><a href="../reference/wb_to_df.html">wb_read()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/381" class="external-link">381</a></p></li>
<li><p>Allow reading files with xml namespace created by third party software. <a href="https://github.com/JanMarvin/openxlsx2/pull/405" class="external-link">405</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-4">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-4"></a></h3>
<ul><li><p>Update or remove calculation chain when overwriting formulas in a workbook. <a href="https://github.com/JanMarvin/openxlsx2/pull/438" class="external-link">438</a></p></li>
<li><p>Fix double xml escaping when saving. <a href="https://github.com/JanMarvin/openxlsx2/pull/435" class="external-link">435</a></p></li>
<li><p>Minor tweak for POSIXct dates and try to avoid the notorious 29Feb1900. <a href="https://github.com/JanMarvin/openxlsx2/pull/424" class="external-link">424</a></p></li>
<li><p>Implement reading <code>customXml</code> folder for input files with connection. <a href="https://github.com/JanMarvin/openxlsx2/pull/419" class="external-link">419</a></p></li>
<li><p>Fixed saving files with <code>&lt;sheetPr/&gt;</code> tag. Previously this was wrapped in a second <code>sheetPr</code> node. This issue occurs with xlsm files only. <a href="https://github.com/JanMarvin/openxlsx2/pull/417" class="external-link">417</a></p></li>
<li><p>Fixed a case where embedded files were assigned incorrectly in worksheet relationships. This caused corrupted output. <a href="https://github.com/JanMarvin/openxlsx2/pull/403" class="external-link">403</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-4">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-4"></a></h3>
<ul><li><p>Remove <code>merge_</code> functions for styles. <a href="https://github.com/JanMarvin/openxlsx2/issues/450" class="external-link">450</a></p></li>
<li><p>Previously if a loaded workbook contained formulas pointing to cells modified by <code>openxlsx2</code>, these formulas were not updated, once the workbook was opened in spreadsheet software. This is now enforced, unless the option <code>openxlsx2.disableFullCalcOnLoad</code> is set. In this case we would respect the original calculation properties of the workbook.</p></li>
<li><p><code><a href="../reference/wb_save.html">wb_save()</a></code> no longer returns the <code>path</code> that the object was saved to, but instead the <code>wbWorkbook</code> object, invisibly. This is consistent with the behavior of others wrappers. <a href="https://github.com/JanMarvin/openxlsx2/issues/378" class="external-link">378</a></p></li>
<li><p>Remove never used <code>all.equal.wbWorkbook()</code>. The idea was nice, but it never developed into something useful.</p></li>
<li><p>Remove never used <code>wb_chart_sheet()</code> function. <a href="https://github.com/JanMarvin/openxlsx2/pull/399" class="external-link">399</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-0-4">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-0-4"></a></h3>
<ul><li>Provide <code>set_sheetview()</code> in sheets. Can be used to provide a <code>wbWorkbook</code> function and wrapper in the future. <a href="https://github.com/JanMarvin/openxlsx2/pull/399" class="external-link">399</a>
</li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3.1" id="openxlsx2-031">openxlsx2 0.3.1<a class="anchor" aria-label="anchor" href="#openxlsx2-031"></a></h2><p class="text-muted">CRAN release: 2022-10-31</p>
<div class="section level3">
<h3 id="new-features-0-3-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-3-1"></a></h3>
<ul><li><p>Functions adding data to a workbook now bring an <code>applyCellStyle</code> argument. If this is <code>TRUE</code> <code>openxlsx2</code> will apply a numeric style, if <code>FALSE</code> we will simply add the numeric value without additional styling and use the previous cell style. <a href="https://github.com/JanMarvin/openxlsx2/pull/365" class="external-link">365</a></p></li>
<li><p>Reading from file or workbook with <code>showFormula</code> now returns all formulas found in the workbook. Previously only those with type <code>e</code> or <code>str</code> were returned. Now we will be able to see formulas like hyperlinks too. <a href="https://github.com/JanMarvin/openxlsx2/issues/352" class="external-link">352</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-0-3-1">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-0-3-1"></a></h3>
<ul><li><p>Moved data validation list from x14 to data validation. This enables data validation lists without x14 extension <a href="https://github.com/ycphs/openxlsx/issues/386" class="external-link">openxlsx 386</a>. <a href="https://github.com/JanMarvin/openxlsx2/pull/347" class="external-link">347</a></p></li>
<li><p>Removed <code>build_cell_merges()</code> and replaced it with a plain R solution. <a href="https://github.com/JanMarvin/openxlsx2/pull/390" class="external-link">390</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-3-1">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-3-1"></a></h3>
<ul><li><p>Improvements to setting column widths. Previously values set by <code>set_col_widths()</code> were a little off. This has now been improved. There are still corner cases where the column width set with <code>openxlsx2</code> does not match those shown in spreadsheet software. Notable differences can be seen with floating point values (e.g., <code>10L</code> works while <code>10.1</code> is slightly off) and with column width on Mac. <a href="https://github.com/JanMarvin/openxlsx2/pull/350" class="external-link">350</a></p></li>
<li><p>Improve <code>rowNames</code> when writing data to worksheet. Previously the name for the rownames column defaulted to <code>1</code>. This has been changed. Now with data it defaults to an empty cell and with a data table it defaults to <code>_rowNames_</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/375" class="external-link">375</a></p></li>
<li><p>Fix the workbook xml relationship file to not include a reference to shared strings per default. This solves <a href="https://github.com/JanMarvin/openxlsx2/issues/360" class="external-link">360</a> for plain data files written from <code>openxlsx2</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/363" class="external-link">363</a></p></li>
<li><p>Adding cell styles has been streamlined to increase consistency. This includes all style functions like <code><a href="../reference/wb_add_font.html">wb_add_font()</a></code> and covers all cases of hyperlinks. <a href="https://github.com/JanMarvin/openxlsx2/pull/365" class="external-link">365</a></p></li>
<li><p>Fix cloning pivot charts. <a href="https://github.com/JanMarvin/openxlsx2/issues/361" class="external-link">361</a></p></li>
<li><p>Fix loading and writing files with slicers. Loading would add a few empty slicer xml files to <code>Content_Types</code> and <code>workbook.xml.rels</code>. <a href="https://github.com/JanMarvin/openxlsx2/issues/361" class="external-link">361</a></p></li>
<li><p>Align the logic for writing data to empty worksheets and updating/writing to worksheets with data. This removes <code>update_cell_loop()</code> and changes how <code>update_cell()</code> behaves. Not only does this remove duplicated code, it also brings great speed improvements (issue <a href="https://github.com/JanMarvin/openxlsx2/issues/356" class="external-link">356</a>). <a href="https://github.com/JanMarvin/openxlsx2/issues/356" class="external-link">356</a></p></li>
<li><p>It is now possible to use special characters in formulas without coding. Previously <code>&amp;</code> had to be encoded like <code>&amp;amp;</code> <a href="https://github.com/JanMarvin/openxlsx2/issues/251" class="external-link">251</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-3-1">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-3-1"></a></h3>
<ul><li><p>Previously deprecated <code>names.wbWorkbook()</code> and <code>names&lt;-.wbWorkbook()</code> have been removed. <a href="https://github.com/JanMarvin/openxlsx2/pull/367" class="external-link">367</a></p></li>
<li><p>Conditional style defaults for <code><a href="../reference/create_dxfs_style.html">create_dxfs_style()</a></code> have changed to be more permissive. Previously we shipped a default font, default font size and font color. This has been changed to better reflect a behavior the user expects. <a href="https://github.com/JanMarvin/openxlsx2/issues/343" class="external-link">343</a></p></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.3" id="openxlsx2-03">openxlsx2 0.3<a class="anchor" aria-label="anchor" href="#openxlsx2-03"></a></h2><p class="text-muted">CRAN release: 2022-09-30</p>
<div class="section level3">
<h3 id="new-features-0-3">New features<a class="anchor" aria-label="anchor" href="#new-features-0-3"></a></h3>
<ul><li><p>New argument <code>startCol</code> in read to data frame functions <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code>, <code><a href="../reference/wb_to_df.html">wb_read()</a></code> and <code><a href="../reference/wb_to_df.html">read_xlsx()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/issues/330" class="external-link">330</a></p></li>
<li><p>New function <code><a href="../reference/wb_color.html">wb_colour()</a></code> to ease working with color vectors used in <code>openxlsx2</code> styles. <a href="https://github.com/JanMarvin/openxlsx2/issues/292" class="external-link">292</a></p></li>
<li><p>Deprecated <code>get_cell_style()</code> and <code>set_cell_style()</code> in favor of newly introduced wrapper functions <code><a href="../reference/wb_cell_style.html">wb_get_cell_style()</a></code> and <code><a href="../reference/wb_cell_style.html">wb_set_cell_style()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/issues/306" class="external-link">306</a></p></li>
<li><p>Improvements to <code><a href="../reference/wb_clone_worksheet.html">wb_clone_worksheet()</a></code>. Cloning of chartsheets as well as worksheets containing charts, pivot tables, drawings and tables is now possible or tweaked. Slicers are removed from the cloned worksheet. <a href="https://github.com/JanMarvin/openxlsx2/issues/305" class="external-link">305</a></p></li>
<li><p>Allow writing class <code>data.table</code>. <a href="https://github.com/JanMarvin/openxlsx2/issues/313" class="external-link">313</a></p></li>
<li><p>Provide <code>na.numbers</code> for reading functions, that convert numbers to <code>NA</code> in R output. Handle <code>na.strings</code> in <code><a href="../reference/write_xlsx.html">write_xlsx()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/issues/301" class="external-link">301</a></p></li>
<li><p>Add new option to add sparklines with various style options to worksheets: <code><a href="../reference/wb_add_sparklines.html">wb_add_sparklines()</a></code>. Sparklines can be created with <code><a href="../reference/create_sparklines.html">create_sparklines()</a></code>. The manual page contains an example. <a href="https://github.com/JanMarvin/openxlsx2/issues/280" class="external-link">280</a></p></li>
<li><p>Add new options to data validation. allow type custom, add arguments <code>errorStyle</code>, <code>errorTitle</code>, <code>error</code>, <code>promptTitle</code>, <code>prompt</code>. <a href="https://github.com/JanMarvin/openxlsx2/issues/271" class="external-link">271</a></p></li>
<li><p>Provide <code><a href="../reference/wb_clone_sheet_style.html">wb_clone_sheet_style()</a></code>. This improves upon the now deprecated<code>cloneSheetStyle()</code> that existed as an early draft. <a href="https://github.com/JanMarvin/openxlsx2/issues/233" class="external-link">233</a></p></li>
<li><p><code>wb$add_data()</code> now checks earlier for missing <code>x</code> argument. <a href="https://github.com/JanMarvin/openxlsx2/issues/165" class="external-link">246</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-0-3">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-0-3"></a></h3>
<ul><li><p>Worksheets added to a <code>wbWorkbook</code> no longer contain default references to the <code>drawings</code> and <code>vmlDrawings</code> directories. Previously, these references were added as <code>rId1</code> and <code>rId2</code> even if the worksheet did not contain any drawing (e.g., an image or a chart) or vml drawing (e.g., a comment or a button). In such cases certain third party software, strictly following the references in worksheet or <code>Content_Types</code> complained about missing files and the import of such files failed completely. <a href="https://github.com/JanMarvin/openxlsx2/pull/311" class="external-link">311</a></p></li>
<li><p>Implement loading of user defined chartShapes. Previously this was not implemented instead the previous logic assumed that every sheet has a matching drawing. With chartShapes this no longer is true. The number of drawings and the number of worksheets/chartsheets must not match. <a href="https://github.com/JanMarvin/openxlsx2/pull/323" class="external-link">323</a></p></li>
<li><p>When loading files with charts, they are now imported into the <code>wbWorkbook</code> object. Previously they were simply copied. This will allow easier interaction with charts in the future. <a href="https://github.com/JanMarvin/openxlsx2/pull/304" class="external-link">304</a></p></li>
<li><p>Moving the data validation code from the workbook to the worksheet. Also, <code>data_validation_list()</code> is no longer stored in <code>dataValidationLst</code>. It has been moved to <code>extLst</code>, fixing a bug when saving and adding another data validation list. The code for retrieving the date origin from a workbook has been improved and <code>get_date_origin(wb, origin = TRUE)</code> now returns the origin as an integer from a <code>wbWorkbook</code>. <a href="https://github.com/JanMarvin/openxlsx2/pull/299" class="external-link">299</a></p></li>
<li><p>Removed level4 from XML functions. There was only a single use case for a level4 function that has been solved differently. If level4 is needed, this can be solved using a level3 and additional level2 functions. In addition xml_nodes now return nodes for all reachable nestings, therefore <code>xml_node("&lt;a/&gt;&lt;a/&gt;", "a")</code> will now return a character vector of length two. For <code>xml_node("&lt;a/&gt;&lt;b/&gt;", "a")</code> only a single character vector is returned. <a href="https://github.com/JanMarvin/openxlsx2/issues/280" class="external-link">280</a></p></li>
<li><p>Changes to various internal pugixml functions, to improve handling of XML strings. <a href="https://github.com/JanMarvin/openxlsx2/issues/279" class="external-link">279</a></p></li>
<li><p>Provide internal helper <code><a href="../reference/xml_rm_child.html">xml_rm_child()</a></code> to remove children of XML strings. <a href="https://github.com/JanMarvin/openxlsx2/issues/273" class="external-link">273</a></p></li>
<li><p>Fixes a bug in <code>update_cell()</code> that slowed down writing on worksheets with data. In addition, this function has been cleaned up and further improved. It is no longer exported, as users only need to use <code><a href="../reference/wb_add_data.html">wb_add_data()</a></code> or <code><a href="../reference/write_data.html">write_data()</a></code>, each of which calls <code>update_cell()</code> under the hood. <a href="https://github.com/JanMarvin/openxlsx2/pull/275" class="external-link">275</a> <a href="https://github.com/JanMarvin/openxlsx2/pull/276" class="external-link">276</a></p></li>
<li><p>Various (mostly internal) changes to <code>conditional_formatting</code>. Created <code>style_mgr</code> integration for <code>dxf</code> (cf-styles) and cleaned up internal code. The syntax has changed slightly, see <a href="https://janmarvin.github.io/openxlsx2/articles/conditional-formatting.html">conditional formatting vignette</a> for reference. Add <code>whitespace</code> argument to <code><a href="../reference/read_xml.html">read_xml()</a></code>. <a href="https://github.com/JanMarvin/openxlsx2/issues/268" class="external-link">268</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-3">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-3"></a></h3>
<ul><li>Order of arguments in reading functions <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code>, <code><a href="../reference/wb_to_df.html">wb_read()</a></code> and <code>read_xls()</code> has changed.</li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.1" id="openxlsx2-021">openxlsx2 0.2.1<a class="anchor" aria-label="anchor" href="#openxlsx2-021"></a></h2>
<div class="section level3">
<h3 id="new-features-0-2-1">New features<a class="anchor" aria-label="anchor" href="#new-features-0-2-1"></a></h3>
<ul><li><p>Data adding functions now ship a <code>dims</code> argument that can be used to determine the <code>startCol</code> and <code>startRow</code> for any <code>x</code> object that is added to the worksheet. Works with <code>add_data()</code>, <code>add_data_table()</code>, <code>add_formula()</code> and their underlying <code>write_</code> functions as well as with the wrappers.</p></li>
<li><p>Provide optional <code>na.strings</code> argument when writing data to sheets. It can be used to add a custom character string when writing numeric data.</p></li>
<li><p>Improve writing <code>NA</code>, <code>NaN</code>, and <code>-Inf</code>/<code>Inf</code>. <code>NA</code> will be converted to <code>#N/A</code>; <code>NaN</code> will be converted to <code>#VALUE!</code>; <code>Inf</code> will be converted to <code>#NUM!</code>. The same conversion is not applied when reading from a workbook. <a href="https://github.com/JanMarvin/openxlsx2/pull/256" class="external-link">256</a></p></li>
<li><p>Many <code>wbWorkbook</code> methods now contain default sheet values of <code><a href="../reference/waivers.html">current_sheet()</a></code> or <code><a href="../reference/waivers.html">next_sheet()</a></code> (e.g., <code>$add_worksheet(sheet = next_sheet())</code>, <code>$write_data(sheet = curret_sheet()</code>). These internal waiver functions allow the <code>wbWorkbook</code> object to use default expectations for what sheet to interact with. This allows the easier workflow of <code>wb$add_worksheet()$add_data(x = data.frame())</code> where <code>$add_worksheet()</code> knows to add a new worksheet (with a default name), sets that new worksheet to the current worksheet, and then <code>$add_data()</code> picks up the new sheet and places the data there. <a href="https://github.com/JanMarvin/openxlsx2/issues/165" class="external-link">165</a>, <a href="https://github.com/JanMarvin/openxlsx2/pull/179" class="external-link">179</a></p></li>
<li><p>New functions <code><a href="../reference/wb_add_cell_style.html">wb_add_cell_style()</a></code> and <code>wb$add_cell_style()</code> to simplify the creation of cell styles for cells on the sheet. This provides a fast way to create cell styles for regions on the worksheet. The cells for which the cell format is to be created must already exist on the worksheet. If the cells already contain a cell format, it will be preserved, except for the updated cell format entries, which will always be created. The function is applied to a continuous cell of the worksheet. <a href="https://github.com/JanMarvin/openxlsx2/pull/230" class="external-link">230</a></p></li>
<li><p>New functions <code><a href="../reference/wb_add_numfmt.html">wb_add_numfmt()</a></code> and <code>wb$add_numfmt()</code> to simplify the creation of number formats for cells on the sheet. This provides a fast way to create number formats for regions on the worksheet. The cells for which the number format is to be created must already exist on the worksheet. If the cells already contain a cell style, it will be preserved, except for the number format, which will always be created. The function is applied to a continuous cell of the worksheet. <a href="https://github.com/JanMarvin/openxlsx2/pull/229" class="external-link">229</a></p></li>
<li><p>New functions <code><a href="../reference/wb_add_font.html">wb_add_font()</a></code> and <code>wb$add_font()</code> to simplify the creation of fonts for cells on the sheet. This provides a fast way to create fonts for regions on the worksheet. The cells for which the font is to be created must already exist on the worksheet. If the cells already contain a cell style, it will be preserved, except for the font, which will always be created. The function is applied to a continuous cell of the worksheet. <a href="https://github.com/JanMarvin/openxlsx2/pull/228" class="external-link">228</a></p></li>
<li><p>New functions <code><a href="../reference/wb_add_fill.html">wb_add_fill()</a></code> and <code>wb$add_fill()</code> to simplify the creation of fills for cells on the sheet. This provides a fast way to create color filled regions on the worksheet. The cells for which the fill is to be created must already exist on the worksheet. If the cells already contain a cell style, it will be preserved, except for the filled color, which will always be created. The function is applied to a continuous cell of the worksheet and allows to change the color of every n-th column or row. <a href="https://github.com/JanMarvin/openxlsx2/pull/222" class="external-link">222</a></p></li>
<li><p>New functions <code><a href="../reference/wb_add_border.html">wb_add_border()</a></code> and <code>wb$add_border()</code> to simplify the creation of borders for cells on the sheet. This is especially useful when creating surrounding borders with different border styles for various cells. The cells for which the border is to be created must already exist on the worksheet. If the cells already contain a cell style, it will be preserved, except for the border, which will always be created. The function is applied to a continuous cell of the worksheet and allows to change the horizontal and vertical internal border grid independently. <a href="https://github.com/JanMarvin/openxlsx2/pull/220" class="external-link">220</a></p></li>
<li><p>Enable reading tables with <code><a href="../reference/wb_to_df.html">wb_to_df()</a></code>. Tables are handled similar to defined names. <a href="https://github.com/JanMarvin/openxlsx2/pull/193" class="external-link">193</a></p></li>
<li>
<p>Several enhancements have been added for checking and validation worksheet names <a href="https://github.com/JanMarvin/openxlsx2/issues/165" class="external-link">165</a></p>
<ul><li>When adding a new worksheet via <code>wbWorkbook$add_worksheet()</code> the provided name is checked for illegal characters (see note in <strong>Breaking changes</strong>)</li>
<li>
<code>wbWorkbook$get_sheet_names()</code> (<code><a href="../reference/sheet_names-wb.html">wb_get_sheet_names()</a></code> wrapper) added. These return both the <em>formatted</em> and original sheet names</li>
<li>
<code>wbWorkbook$set_sheet_names()</code> (<code><a href="../reference/sheet_names-wb.html">wb_set_sheet_names()</a></code>) added
<ul><li>these make <code>names.wbWorkbook()</code> and <code>names&lt;-.wbWorkbook()</code> deprecated</li>
<li>
<code>wbWorkbook$setSheetName()</code> deprecated</li>
</ul></li>
<li>
<code>clean_worksheet_names()</code> added to support removing characters that are not allowed in worksheet names</li>
</ul></li>
</ul></div>
<div class="section level3">
<h3 id="fixes-0-2-1">Fixes<a class="anchor" aria-label="anchor" href="#fixes-0-2-1"></a></h3>
<ul><li><p>Various fixes to enable handling of non unicode R environments <a href="https://github.com/JanMarvin/openxlsx2/issues/243" class="external-link">243</a></p></li>
<li><p>Fix an issue with broken pageSetup reference causing corrupt excel files <a href="https://github.com/JanMarvin/openxlsx2/issues/216" class="external-link">216</a></p></li>
<li><p>Fix reading and writing comments from workbooks that already provide comments <a href="https://github.com/JanMarvin/openxlsx2/pull/209" class="external-link">209</a></p></li>
<li><p>Fix an issue with broken xml in Excels vml files and enable opening xlsm files with <code>wb$open()</code> <a href="https://github.com/JanMarvin/openxlsx2/pull/202" class="external-link">202</a></p></li>
<li><p>Fix reading and writing on non UTF-8 systems <a href="https://github.com/JanMarvin/openxlsx2/pull/198" class="external-link">198</a> <a href="https://github.com/JanMarvin/openxlsx2/pull/199" class="external-link">199</a> <a href="https://github.com/JanMarvin/openxlsx2/pull/207" class="external-link">207</a></p></li>
<li><p>Instruct parser to import nodes with whitespaces. This fixes a complaint in spreadsheet software. <a href="https://github.com/JanMarvin/openxlsx2/pull/189" class="external-link">189</a></p></li>
<li><p>Fix reading file without row attribute. <a href="https://github.com/JanMarvin/openxlsx2/pull/187" class="external-link">187</a> <a href="https://github.com/JanMarvin/openxlsx2/pull/190" class="external-link">190</a></p></li>
<li><p>Remove reference to <code>printerSettings.bin</code> when loading. This binary blob is not included and the reference caused file corruption warnings. <a href="https://github.com/JanMarvin/openxlsx2/pull/185" class="external-link">185</a></p></li>
<li><p>Fix loading and writing xlsx files with with <code>workbook$extLst</code>. Previously if the loaded sheet contains a slicer, a second <code>extLst</code> was added which confused spreadsheet software. Now both are combined into a single node.</p></li>
<li><p>Fix writing xlsx file with multiple entries of conditional formatting type databar on any sheet. <a href="https://github.com/JanMarvin/openxlsx2/pull/174" class="external-link">174</a></p></li>
<li><p>Cell fields cm, ph and vm are now implemented for reading and writing. This is the first step to handle functions that use metadata. <a href="https://github.com/JanMarvin/openxlsx2/pull/173" class="external-link">173</a></p></li>
<li><p><code>wbWorkbook</code>: <code>$open()</code> no longer overwrites the <code>$path</code> field to the temporary file <a href="https://github.com/JanMarvin/openxlsx2/pull/171" class="external-link">171</a></p></li>
<li><p><code><a href="../reference/xl_open.html">xl_open()</a></code> works (better) on Windows <a href="https://github.com/JanMarvin/openxlsx2/issues/170" class="external-link">170</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="breaking-changes-0-2-1">Breaking changes<a class="anchor" aria-label="anchor" href="#breaking-changes-0-2-1"></a></h3>
<ul><li><p>When writing to existing workbooks, the default value for <code>removeCellStyle</code> is now <code>FALSE</code>. Therefore if a cell contains a style, it is attempted to replace the value, but not the style of the cell itself.</p></li>
<li>
<p><code>wb_conditional_formatting()</code> is deprecated in favor of <code><a href="../reference/wb_add_conditional_formatting.html">wb_add_conditional_formatting()</a></code> and <code>wbWorkbook$add_conditional_formatting()</code>.</p>
<ul><li>
<code>type</code> must now match exactly one of: <code>"expression"</code>, <code>"colorScale"</code>, <code>"dataBar"</code>, <code>"duplicatedValues"</code>, <code>"containsText"</code>, <code>"notContainsText"</code>, <code>"beginsWith"</code>, <code>"endsWith"</code>, <code>"between"</code>, <code>"topN"</code>, <code>"bottomN"</code>
</li>
</ul></li>
<li><p>Assigning a new worksheet with an illegal character now prompts an error <a href="https://github.com/JanMarvin/openxlsx2/issues/165" class="external-link">165</a>. See <code><a href="../reference/clean_worksheet_name.html">?clean_worksheet_name</a></code> for an easy method of replacing bad characters.</p></li>
<li><p><code>openxlsx2Coerce()</code> (which was called on <code>x</code> objects when adding data to a workbook) has been removed. Users can no longer pass some arbitrary objects and will need to format these objects appropriately or rely on <code>as.data.frame</code> methods <a href="https://github.com/JanMarvin/openxlsx2/issues/167" class="external-link">167</a></p></li>
<li><p><code>xl_open(file = )</code> is no longer valid and will throw a warning; first argument has been changes to <code>x</code> to highlight that <code><a href="../reference/xl_open.html">xl_open()</a></code> can be called on a file path or a <code>wbWorkbook</code> object <a href="https://github.com/JanMarvin/openxlsx2/pull/171" class="external-link">171</a></p></li>
</ul></div>
<div class="section level3">
<h3 id="internal-changes-0-2-1">Internal changes<a class="anchor" aria-label="anchor" href="#internal-changes-0-2-1"></a></h3>
<ul><li><p>Remove <code>wb$createFontNode()</code> which was never used.</p></li>
<li><p>Switch to modern xlsx template, when creating workbooks. Imported workbooks will use the imported template</p></li>
<li><p>Rewrite <code>wb$tables</code> to use a data frame approach. This simplifies the code a bit and makes it easier to implement more upcoming changes <a href="https://github.com/JanMarvin/openxlsx2/pull/191" class="external-link">191</a></p></li>
<li><p>Update of internal pugixml library</p></li>
<li><p>The two functions <code><a href="../reference/write_data.html">write_data()</a></code> and <code><a href="../reference/write_datatable.html">write_datatable()</a></code> now use the same internal function <code>write_data_table()</code> to add data to the sheet. This simplifies the code and ensures that both functions are tested. In the same pull request, the documentation has been updated and the <code>stack=</code> option, which was not present before, has been removed <a href="https://github.com/JanMarvin/openxlsx2/pull/175" class="external-link">175</a></p></li>
<li><p><code>wbWorkbook$validate_sheet()</code> added as an object methods</p></li>
<li><p>private <code>wbWorkbook</code> field <code>original_sheet_names</code> added to track the original names passed to sheets</p></li>
<li><p>private <code>$get_sheet()</code> removed in favor of more explicit</p></li>
<li>
<p>private <code>wbWorkbook</code> methods additions:</p>
<ul><li>
<code>$get_sheet_id_max()</code>, <code>$get_sheet_index()</code> for getting ids</li>
<li>
<code>$get_sheet_name()</code> for getting a sheet name</li>
<li>
<code>$set_single_sheet_name()</code> for setting sheet names</li>
<li>
<code>$pappend()</code> general private appending</li>
<li>
<code>$validate_new_sheet()</code> for checking new sheet names</li>
<li>
<code>$append_workbook_field()</code> for <code>self$workbook[[field]]</code>
</li>
<li>
<code>$append_sheet_rels()</code> for <code>self$worksheet_rels[[sheet]]</code>
</li>
<li>
<code>$get_worksheet()</code> to replace <code>$ws()</code>
</li>
</ul></li>
</ul><hr></div>
</div>
    <div class="section level2">
<h2 class="pkg-version" data-toc-text="0.2.0" id="openxlsx2-020">openxlsx2 0.2.0<a class="anchor" aria-label="anchor" href="#openxlsx2-020"></a></h2>
<ul><li>Added a <code>NEWS.md</code> file to track changes to the package.</li>
<li>First public release</li>
</ul></div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jordan Mark Barbone, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

