<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>xlsx reading, writing and editing. — openxlsx2-package • openxlsx2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="xlsx reading, writing and editing. — openxlsx2-package"><meta name="description" content="This R package is a modern reinterpretation of the widely used popular
openxlsx package. Similar to its predecessor, it simplifies the creation of xlsx
files by providing a clean interface for writing, designing and editing worksheets.
Based on a powerful XML library and focusing on modern programming flows in pipes
or chains, openxlsx2 allows to break many new ground."><meta property="og:description" content="This R package is a modern reinterpretation of the widely used popular
openxlsx package. Similar to its predecessor, it simplifies the creation of xlsx
files by providing a clean interface for writing, designing and editing worksheets.
Based on a powerful XML library and focusing on modern programming flows in pipes
or chains, openxlsx2 allows to break many new ground."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">openxlsx2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.11.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/openxlsx2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/conditional-formatting.html">Add conditional formatting to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_charts_manual.html">Add charts to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_formulas_manual.html">Add formulas to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_read_to_df.html">openxlsx2 read to data frame manual</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_style_manual.html">Add styling to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/Update-from-openxlsx.html">Upgrade from openxlsx</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JanMarvin/openxlsx2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>xlsx reading, writing and editing.</h1>
      <small class="dont-index">Source: <a href="https://github.com/JanMarvin/openxlsx2/blob/main/R/openxlsx2-package.R" class="external-link"><code>R/openxlsx2-package.R</code></a></small>
      <div class="d-none name"><code>openxlsx2-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This R package is a modern reinterpretation of the widely used popular
<code>openxlsx</code> package. Similar to its predecessor, it simplifies the creation of xlsx
files by providing a clean interface for writing, designing and editing worksheets.
Based on a powerful XML library and focusing on modern programming flows in pipes
or chains, <code>openxlsx2</code> allows to break many new ground.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>openxlsx2</code> package provides comprehensive functionality for interacting
with Office Open XML spreadsheet files. Users can read data using <code><a href="wb_to_df.html">read_xlsx()</a></code>
and write data to spreadsheets via <code><a href="write_xlsx.html">write_xlsx()</a></code>, with options to specify
sheet names and cell ranges for targeted operations. Beyond basic read/write
capabilities, <code>openxlsx2</code> facilitates extensive workbook (<code><a href="wb_workbook.html">wb_workbook()</a></code>)
manipulations, including:</p><ul><li><p>Loading a workbook into R with <code><a href="wb_load.html">wb_load()</a></code> and saving it with <code><a href="wb_save.html">wb_save()</a></code></p></li>
<li><p>Adding/removing and modifying worksheets and data with <code><a href="wb_add_worksheet.html">wb_add_worksheet()</a></code>,
<code><a href="wb_remove_worksheet.html">wb_remove_worksheet()</a></code>, and <code><a href="wb_add_data.html">wb_add_data()</a></code>.</p></li>
<li><p>Enhancing spreadsheets with comments (<code><a href="wb_add_comment.html">wb_add_comment()</a></code>),
images (<code><a href="wb_add_image.html">wb_add_image()</a></code>), plots (<code><a href="wb_add_plot.html">wb_add_plot()</a></code>), charts (<code><a href="wb_add_mschart.html">wb_add_mschart()</a></code>),
and pivot tables (<code><a href="wb_add_pivot_table.html">wb_add_pivot_table()</a></code>).
Customizing cell styles using fonts (<code><a href="wb_add_font.html">wb_add_font()</a></code>),
number formats (<code><a href="wb_add_numfmt.html">wb_add_numfmt()</a></code>), backgrounds (<code><a href="wb_add_fill.html">wb_add_fill()</a></code>),
and alignments (<code><a href="wb_add_cell_style.html">wb_add_cell_style()</a></code>). Inserting custom text strings with
<code><a href="fmt_txt.html">fmt_txt()</a></code> and creating comprehensive table styles with <code><a href="create_tablestyle.html">create_tablestyle()</a></code>.</p></li>
</ul><div class="section">
<h3 id="interaction">Interaction<a class="anchor" aria-label="anchor" href="#interaction"></a></h3>


<p>Interaction with <code>openxlsx2</code> objects can occur through two primary methods:</p>
<p><em>Wrapper Function Method</em>: Utilizes the <code>wb</code> family of functions that support
piping to streamline operations.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span>creator <span class="op">=</span> <span class="st">"My name here"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"Expenditure"</span>, grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">USPersonalExpenditure</span>, row_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre><p></p></div>
<p><em>Chaining Method</em>: Directly modifies the object through a series of chained
function calls.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wb_workbook.html">wb_workbook</a></span><span class="op">(</span>creator <span class="op">=</span> <span class="st">"My name here"</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_worksheet</span><span class="op">(</span>sheet <span class="op">=</span> <span class="st">"Expenditure"</span>, grid_lines <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span></span>
<span>  <span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="va">USPersonalExpenditure</span>, row_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre><p></p></div>
<p>While wrapper functions require explicit assignment of their output to reflect
changes, chained functions inherently modify the input object. Both approaches
are equally supported, offering flexibility to suit user preferences. The
documentation mainly highlights the use of wrapper functions. To find information,
users should look up the wb function name e.g. <code><a href="wb_add_data_table.html">?wb_add_data_table</a></code> rather than
searching for <code><a href="wbWorkbook.html">?wbWorkbook</a></code>.</p>
<p>Function arguments follow the snake_case convention, but for backward compatibility,
camelCase is also supported at the moment. The API aims to maintain consistency
in its arguments, with a special focus on <code>sheet</code> (<code><a href="sheet_names-wb.html">wb_get_sheet_names()</a></code>) and
<code>dims</code> (<a href="wb_dims.html">wb_dims</a>), which are of particular importance to users.</p>
</div>

<div class="section">
<h3 id="locale">Locale<a class="anchor" aria-label="anchor" href="#locale"></a></h3>


<p>By default, <code>openxlsx2</code> uses the American English word for color (written with
'o' instead of the British English 'ou'). However, both spellings are supported.
So where the documentation uses a 'color', the function should also accept a 'colour'.
However, this is not indicated by the autocompletion.</p>
</div>

<div class="section">
<h3 id="authors-and-contributions">Authors and contributions<a class="anchor" aria-label="anchor" href="#authors-and-contributions"></a></h3>


<p>For a full list of all authors that have made this package possible and for whom we are grateful, please see:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"AUTHORS"</span>, package <span class="op">=</span> <span class="st">"openxlsx2"</span><span class="op">)</span></span></code></pre><p></p></div>
<p>If you feel like you should be included on this list, please let us know.
If you have something to contribute, you are welcome.
If something is not working as expected, open issues or if you have solved an issue, open a pull request.
Please be respectful and be aware that we are volunteers doing this for fun in our unpaid free time.
We will work on problems when we have time or need.</p>
</div>

<div class="section">
<h3 id="license">License<a class="anchor" aria-label="anchor" href="#license"></a></h3>


<p>This package is licensed under the MIT license and
is based on <a href="https://github.com/ycphs/openxlsx" class="external-link"><code>openxlsx</code></a> (by Alexander Walker and Philipp Schauberger; COPYRIGHT 2014-2022)
and <a href="https://github.com/zeux/pugixml" class="external-link"><code>pugixml</code></a> (by Arseny Kapoulkine; COPYRIGHT 2006-2023). Both released under the MIT license.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code>browseVignettes("openxlsx2")</code></p></li>
<li><p><a href="https://janmarvin.github.io/openxlsx2/">https://janmarvin.github.io/openxlsx2/</a></p></li>
<li><p><a href="https://janmarvin.github.io/ox2-book/" class="external-link">https://janmarvin.github.io/ox2-book/</a>
for examples</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p><strong>Maintainer</strong>: Jan Marvin Garbuszus <a href="mailto:jan.garbuszus@ruhr-uni-bochum.de">jan.garbuszus@ruhr-uni-bochum.de</a></p>
<p>Authors:</p><ul><li><p>Jordan Mark Barbone <a href="mailto:jmbarbone@gmail.com">jmbarbone@gmail.com</a> (<a href="https://orcid.org/0000-0001-9788-3628" class="external-link">ORCID</a>)</p></li>
</ul><p>Other contributors:</p><ul><li><p>Olivier Roy [contributor]</p></li>
<li><p>openxlsx authors (openxlsx package) [copyright holder]</p></li>
<li><p>Arseny Kapoulkine (Author of included pugixml code) [contributor, copyright holder]</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># read xlsx or xlsm files</span></span></span>
<span class="r-in"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/openxlsx2_example.xlsx"</span>, package <span class="op">=</span> <span class="st">"openxlsx2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wb_to_df.html">read_xlsx</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Var1 Var2 NA  Var3  Var4       Var5         Var6    Var7     Var8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   TRUE    1 NA     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   TRUE   NA NA #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   TRUE    2 NA  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  FALSE    3 NA  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  FALSE    1 NA   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     NA   NA NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 FALSE    2 NA    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 FALSE    3 NA  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    NA    1 NA   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># or import workbooks</span></span></span>
<span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="wb_load.html">wb_load</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># read a data frame</span></span></span>
<span class="r-in"><span><span class="fu"><a href="wb_to_df.html">wb_to_df</a></span><span class="op">(</span><span class="va">wb</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Var1 Var2 NA  Var3  Var4       Var5         Var6    Var7     Var8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   TRUE    1 NA     1     a 2023-05-29 3209324 This #DIV/0! 01:27:15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   TRUE   NA NA #NUM!     b 2023-05-23         &lt;NA&gt;       0 14:02:57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   TRUE    2 NA  1.34     c 2023-02-01         &lt;NA&gt; #VALUE! 23:01:02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  FALSE    2 NA  &lt;NA&gt; #NUM!       &lt;NA&gt;         &lt;NA&gt;       2 17:24:53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  FALSE    3 NA  1.56     e       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  FALSE    1 NA   1.7     f 2023-03-02         &lt;NA&gt;     2.7 08:45:58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9     NA   NA NA  &lt;NA&gt;  &lt;NA&gt;       &lt;NA&gt;         &lt;NA&gt;    &lt;NA&gt;     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 FALSE    2 NA    23     h 2023-12-24         &lt;NA&gt;      25     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11 FALSE    3 NA  67.3     i 2023-12-25         &lt;NA&gt;       3     &lt;NA&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12    NA    1 NA   123  &lt;NA&gt; 2023-07-31         &lt;NA&gt;     122     &lt;NA&gt;</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># and save</span></span></span>
<span class="r-in"><span><span class="va">temp</span> <span class="op">&lt;-</span> <span class="fu"><a href="temp_xlsx.html">temp_xlsx</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="wb_save.html">wb_save</a></span><span class="op">(</span><span class="va">wb</span>, <span class="va">temp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## or create one yourself</span></span></span>
<span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># add a worksheet</span></span></span>
<span class="r-in"><span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"sheet"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># add some data</span></span></span>
<span class="r-in"><span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span><span class="st">"sheet"</span>, <span class="va">cars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># open it in your default spreadsheet software</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="va">wb</span><span class="op">$</span><span class="fu">open</span><span class="op">(</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jordan Mark Barbone, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

