<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The comment functions (create, write and remove) allow the
modification of comments. In newer Excels they are called notes, while they
are called comments in openxml. Modification of what Excel now calls comment
(openxml calls them threadedComments) is not yet possible"><title>Create, write and remove comments — create_comment • openxlsx2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create, write and remove comments — create_comment"><meta property="og:description" content="The comment functions (create, write and remove) allow the
modification of comments. In newer Excels they are called notes, while they
are called comments in openxml. Modification of what Excel now calls comment
(openxml calls them threadedComments) is not yet possible"><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openxlsx2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.7.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Update-from-openxlsx.html">Upgrade from openxlsx</a>
    <a class="dropdown-item" href="../articles/conditional-formatting.html">Conditional Formatting</a>
    <a class="dropdown-item" href="../articles/openxlsx2_basic_manual.html">openxlsx2 basic manual</a>
    <a class="dropdown-item" href="../articles/openxlsx2_charts_manual.html">openxlsx2 charts manual</a>
    <a class="dropdown-item" href="../articles/openxlsx2_formulas_manual.html">openxlsx2 formulas manual</a>
    <a class="dropdown-item" href="../articles/openxlsx2_style_manual.html">openxlsx2 style manual</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JanMarvin/openxlsx2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create, write and remove comments</h1>
      <small class="dont-index">Source: <a href="https://github.com/JanMarvin/openxlsx2/blob/HEAD/R/class-comment.R" class="external-link"><code>R/class-comment.R</code></a>, <a href="https://github.com/JanMarvin/openxlsx2/blob/HEAD/R/class-workbook-wrappers.R" class="external-link"><code>R/class-workbook-wrappers.R</code></a></small>
      <div class="d-none name"><code>comment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The comment functions (create, write and remove) allow the
modification of comments. In newer Excels they are called notes, while they
are called comments in openxml. Modification of what Excel now calls comment
(openxml calls them threadedComments) is not yet possible</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_comment</span><span class="op">(</span></span>
<span>  <span class="va">text</span>,</span>
<span>  author <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.info.html" class="external-link">Sys.info</a></span><span class="op">(</span><span class="op">)</span><span class="op">[[</span><span class="st">"user"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  visible <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  width <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">write_comment</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  <span class="va">sheet</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">comment</span>,</span>
<span>  dims <span class="op">=</span> <span class="fu">rowcol_to_dim</span><span class="op">(</span><span class="va">row</span>, <span class="va">col</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">remove_comment</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  <span class="va">sheet</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gridExpand <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wb_add_comment</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fu"><a href="waivers.html">current_sheet</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dims <span class="op">=</span> <span class="fu">rowcol_to_dim</span><span class="op">(</span><span class="va">row</span>, <span class="va">col</span><span class="op">)</span>,</span>
<span>  <span class="va">comment</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wb_remove_comment</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fu"><a href="waivers.html">current_sheet</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dims <span class="op">=</span> <span class="fu"><a href="dims_helper.html">rowcol_to_dims</a></span><span class="op">(</span><span class="va">row</span>, <span class="va">col</span><span class="op">)</span>,</span>
<span>  gridExpand <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>text</dt>
<dd><p>Comment text. Character vector.</p></dd>


<dt>author</dt>
<dd><p>Author of comment. Character vector of length 1</p></dd>


<dt>style</dt>
<dd><p>A Style object or list of style objects the same length as comment vector.</p></dd>


<dt>visible</dt>
<dd><p>TRUE or FALSE. Is comment visible.</p></dd>


<dt>width</dt>
<dd><p>Textbox integer width in number of cells</p></dd>


<dt>height</dt>
<dd><p>Textbox integer height in number of cells</p></dd>


<dt>wb</dt>
<dd><p>A workbook object</p></dd>


<dt>sheet</dt>
<dd><p>A worksheet of the workbook</p></dd>


<dt>col</dt>
<dd><p>A column to apply the comment</p></dd>


<dt>row</dt>
<dd><p>A row to apply the comment</p></dd>


<dt>comment</dt>
<dd><p>A comment to apply to the worksheet</p></dd>


<dt>dims</dt>
<dd><p>Optional row and column as spreadsheet dimension, e.g. "A1"</p></dd>


<dt>gridExpand</dt>
<dd><p>Remove all comments inside the grid. Similar to dims "A1:B2"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The <code>wbWorkbook</code> object</p>


<p>The <code>wbWorkbook</code> object</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"Sheet 1"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># write comment without author</span></span></span>
<span class="r-in"><span><span class="va">c1</span> <span class="op">&lt;-</span> <span class="fu">create_comment</span><span class="op">(</span>text <span class="op">=</span> <span class="st">"this is a comment"</span>, author <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">write_comment</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"B"</span>, row <span class="op">=</span> <span class="fl">10</span>, comment <span class="op">=</span> <span class="va">c1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Write another comment with author information</span></span></span>
<span class="r-in"><span><span class="va">c2</span> <span class="op">&lt;-</span> <span class="fu">create_comment</span><span class="op">(</span>text <span class="op">=</span> <span class="st">"this is another comment"</span>, author <span class="op">=</span> <span class="st">"Marco Polo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">write_comment</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"C"</span>, row <span class="op">=</span> <span class="fl">10</span>, comment <span class="op">=</span> <span class="va">c2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># write a styled comment with system author</span></span></span>
<span class="r-in"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_font.html">create_font</a></span><span class="op">(</span>b <span class="op">=</span> <span class="st">"true"</span>, color <span class="op">=</span> <span class="fu"><a href="wbColour.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FFFF0000"</span><span class="op">)</span>, sz <span class="op">=</span> <span class="st">"12"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="create_font.html">create_font</a></span><span class="op">(</span>color <span class="op">=</span> <span class="fu"><a href="wbColour.html">wb_color</a></span><span class="op">(</span>hex <span class="op">=</span> <span class="st">"FF000000"</span><span class="op">)</span>, sz <span class="op">=</span> <span class="st">"9"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">c3</span> <span class="op">&lt;-</span> <span class="fu">create_comment</span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"This Part Bold red\n\n"</span>, <span class="st">"This part black"</span><span class="op">)</span>, style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">s1</span>, <span class="va">s2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">write_comment</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="fl">6</span>, row <span class="op">=</span> <span class="fl">3</span>, comment <span class="op">=</span> <span class="va">c3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># remove the first comment</span></span></span>
<span class="r-in"><span><span class="fu">remove_comment</span><span class="op">(</span><span class="va">wb</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"B"</span>, row <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Jordan Mark Barbone, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

