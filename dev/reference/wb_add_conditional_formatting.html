<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Add conditional formatting to cells in a worksheet — wb_add_conditional_formatting • openxlsx2</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add conditional formatting to cells in a worksheet — wb_add_conditional_formatting"><meta name="description" content='Add conditional formatting to cells.
You can find more details in vignette("conditional-formatting").'><meta property="og:description" content='Add conditional formatting to cells.
You can find more details in vignette("conditional-formatting").'><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">openxlsx2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.11.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/openxlsx2.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/conditional-formatting.html">Add conditional formatting to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_charts_manual.html">Add charts to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_formulas_manual.html">Add formulas to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_read_to_df.html">openxlsx2 read to data frame manual</a></li>
    <li><a class="dropdown-item" href="../articles/openxlsx2_style_manual.html">Add styling to a workbook</a></li>
    <li><a class="dropdown-item" href="../articles/Update-from-openxlsx.html">Upgrade from openxlsx</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JanMarvin/openxlsx2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Add conditional formatting to cells in a worksheet</h1>
      <small class="dont-index">Source: <a href="https://github.com/JanMarvin/openxlsx2/blob/main/R/class-workbook-wrappers.R" class="external-link"><code>R/class-workbook-wrappers.R</code></a></small>
      <div class="d-none name"><code>wb_add_conditional_formatting.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add conditional formatting to cells.
You can find more details in <code><a href="../articles/conditional-formatting.html">vignette("conditional-formatting")</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wb_add_conditional_formatting</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fu"><a href="waivers.html">current_sheet</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rule <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  style <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"expression"</span>, <span class="st">"colorScale"</span>, <span class="st">"dataBar"</span>, <span class="st">"iconSet"</span>, <span class="st">"duplicatedValues"</span>,</span>
<span>    <span class="st">"uniqueValues"</span>, <span class="st">"containsErrors"</span>, <span class="st">"notContainsErrors"</span>, <span class="st">"containsBlanks"</span>,</span>
<span>    <span class="st">"notContainsBlanks"</span>, <span class="st">"containsText"</span>, <span class="st">"notContainsText"</span>, <span class="st">"beginsWith"</span>, <span class="st">"endsWith"</span>,</span>
<span>    <span class="st">"between"</span>, <span class="st">"topN"</span>, <span class="st">"bottomN"</span><span class="op">)</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>showValue <span class="op">=</span> <span class="cn">TRUE</span>, gradient <span class="op">=</span> <span class="cn">TRUE</span>, border <span class="op">=</span> <span class="cn">TRUE</span>, percent <span class="op">=</span> <span class="cn">FALSE</span>, rank <span class="op">=</span></span>
<span>    <span class="fl">5L</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">wb_remove_conditional_formatting</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fu"><a href="waivers.html">current_sheet</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dims <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  first <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  last <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-wb">wb<a class="anchor" aria-label="anchor" href="#arg-wb"></a></dt>
<dd><p>A Workbook object</p></dd>


<dt id="arg-sheet">sheet<a class="anchor" aria-label="anchor" href="#arg-sheet"></a></dt>
<dd><p>A name or index of a worksheet</p></dd>


<dt id="arg-dims">dims<a class="anchor" aria-label="anchor" href="#arg-dims"></a></dt>
<dd><p>A cell or cell range like "A1" or "A1:B2"</p></dd>


<dt id="arg-rule">rule<a class="anchor" aria-label="anchor" href="#arg-rule"></a></dt>
<dd><p>The condition under which to apply the formatting. See <strong>Examples</strong>.</p></dd>


<dt id="arg-style">style<a class="anchor" aria-label="anchor" href="#arg-style"></a></dt>
<dd><p>A name of a style to apply to those cells that satisfy the rule. See <code><a href="wb_add_dxfs_style.html">wb_add_dxfs_style()</a></code> how to create one.
The default style has <code>font_color = "FF9C0006"</code> and <code>bg_fill = "FFFFC7CE"</code></p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>The type of conditional formatting rule to apply. One of <code>"expression"</code>, <code>"colorScale"</code> or others mentioned in <strong>Details</strong>.</p></dd>


<dt id="arg-params">params<a class="anchor" aria-label="anchor" href="#arg-params"></a></dt>
<dd><p>A list of additional parameters passed.  See <strong>Details</strong> for more.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments</p></dd>


<dt id="arg-first">first<a class="anchor" aria-label="anchor" href="#arg-first"></a></dt>
<dd><p>remove the first conditional formatting</p></dd>


<dt id="arg-last">last<a class="anchor" aria-label="anchor" href="#arg-last"></a></dt>
<dd><p>remove the last conditional formatting</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>openxml uses the alpha channel first then RGB, whereas the usual default is RGBA.</p>
<p>Conditional formatting <code>type</code> accept different parameters. Unless noted,
unlisted parameters are ignored.</p><dl><dt><code>expression</code></dt>
<dd><p><code>[style]</code><br> A <code>Style</code> object<br><br><code>[rule]</code><br> An Excel expression (as a character). Valid operators are: <code>&lt;</code>, <code>&lt;=</code>, <code>&gt;</code>, <code>&gt;=</code>, <code>==</code>, <code>!=</code></p></dd>

<dt><code>colorScale</code></dt>
<dd><p><code>[style]</code><br> A <code>character</code> vector of valid colors with length <code>2</code> or <code>3</code><br><br><code>[rule]</code><br><code>NULL</code> or a <code>character</code> vector of valid colors of equal length to <code>styles</code></p></dd>

<dt><code>dataBar</code></dt>
<dd><p><code>[style]</code><br> A <code>character</code> vector of valid colors with length <code>2</code> or <code>3</code><br><br><code>[rule]</code><br> A <code>numeric</code> vector specifying the range of the databar colors. Must be equal length to <code>style</code><br><br><code>[params$showValue]</code><br> If <code>FALSE</code> the cell value is hidden. Default <code>TRUE</code><br><br><code>[params$gradient]</code><br> If <code>FALSE</code> color gradient is removed. Default <code>TRUE</code><br><br><code>[params$border]</code><br> If <code>FALSE</code> the border around the database is hidden. Default <code>TRUE</code></p></dd>

<dt><code>duplicatedValues</code> / <code>uniqueValues</code> / <code>containsErrors</code></dt>
<dd><p><code>[style]</code><br> A <code>Style</code> object</p></dd>

<dt><code>contains</code></dt>
<dd><p><code>[style]</code><br> A <code>Style</code> object<br><br><code>[rule]</code><br> The text to look for within cells</p></dd>

<dt><code>between</code></dt>
<dd><p><code>[style]</code><br> A <code>Style</code> object.<br><br><code>[rule]</code><br> A <code>numeric</code> vector of length <code>2</code> specifying lower and upper bound (Inclusive)</p></dd>

<dt><code>topN</code></dt>
<dd><p><code>[style]</code><br> A <code>Style</code> object<br><br><code>[params$rank]</code><br> A <code>numeric</code> vector of length <code>1</code> indicating number of highest values. Default <code>5L</code><br><br><code>[params$percent]</code> If <code>TRUE</code>, uses percentage</p></dd>

<dt><code>bottomN</code></dt>
<dd><p><code>[style]</code><br> A <code>Style</code> object<br><br><code>[params$rank]</code><br> A <code>numeric</code> vector of length <code>1</code> indicating number of lowest values. Default <code>5L</code><br><br><code>[params$percent]</code><br> If <code>TRUE</code>, uses percentage</p></dd>

<dt><code>iconSet</code></dt>
<dd><p><code>[params$showValue]</code><br> If <code>FALSE</code>, the cell value is hidden. Default <code>TRUE</code><br><br><code>[params$reverse]</code><br> If <code>TRUE</code>, the order is reversed. Default <code>FALSE</code><br><br><code>[params$percent]</code><br> If <code>TRUE</code>, uses percentage<br><br><code>[params$iconSet]</code><br> Uses one of the implemented icon sets. Values must match the length of the icons
in the set 3Arrows, 3ArrowsGray, 3Flags, 3Signs, 3Stars, 3Symbols, 3Symbols2, 3TrafficLights1, 3TrafficLights2,
3Triangles, 4Arrows, 4ArrowsGray, 4Rating, 4RedToBlack, 4TrafficLights, 5Arrows, 5ArrowsGray, 5Boxes, 5Quarters, 5Rating.
The default is 3TrafficLights1.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other worksheet content functions:
<code><a href="col_widths-wb.html">col_widths-wb</a></code>,
<code><a href="filter-wb.html">filter-wb</a></code>,
<code><a href="grouping-wb.html">grouping-wb</a></code>,
<code><a href="named_region-wb.html">named_region-wb</a></code>,
<code><a href="row_heights-wb.html">row_heights-wb</a></code>,
<code><a href="wb_add_data.html">wb_add_data</a>()</code>,
<code><a href="wb_add_data_table.html">wb_add_data_table</a>()</code>,
<code><a href="wb_add_formula.html">wb_add_formula</a>()</code>,
<code><a href="wb_add_hyperlink.html">wb_add_hyperlink</a>()</code>,
<code><a href="wb_add_pivot_table.html">wb_add_pivot_table</a>()</code>,
<code><a href="wb_add_slicer.html">wb_add_slicer</a>()</code>,
<code><a href="wb_add_thread.html">wb_add_thread</a>()</code>,
<code><a href="wb_freeze_pane.html">wb_freeze_pane</a>()</code>,
<code><a href="wb_merge_cells.html">wb_merge_cells</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wb</span><span class="op">$</span><span class="fu">add_worksheet</span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wb</span><span class="op">$</span><span class="fu">add_data</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, col_names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">wb</span><span class="op">$</span><span class="fu">add_conditional_formatting</span><span class="op">(</span>dims <span class="op">=</span> <span class="fu"><a href="wb_dims.html">wb_dims</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"A"</span>, rows <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>, rule <span class="op">=</span> <span class="st">"&gt;2"</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jordan Mark Barbone, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

