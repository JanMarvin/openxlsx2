<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The data must be specified using wb_data() to ensure the function works.
The sheet will be empty unless it is opened in spreadsheet software. Find
more details in the section about pivot tables
in the openxlsx2 book."><title>Add a pivot table to a worksheet — wb_add_pivot_table • openxlsx2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add a pivot table to a worksheet — wb_add_pivot_table"><meta property="og:description" content="The data must be specified using wb_data() to ensure the function works.
The sheet will be empty unless it is opened in spreadsheet software. Find
more details in the section about pivot tables
in the openxlsx2 book."><meta name="robots" content="noindex"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">openxlsx2</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.6.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/openxlsx2.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/conditional-formatting.html">Add conditional formatting to a workbook</a>
    <a class="dropdown-item" href="../articles/openxlsx2_charts_manual.html">Add charts to a workbook</a>
    <a class="dropdown-item" href="../articles/openxlsx2_formulas_manual.html">Add formulas to a workbook</a>
    <a class="dropdown-item" href="../articles/openxlsx2_style_manual.html">Add styling to a workbook</a>
    <a class="dropdown-item" href="../articles/Update-from-openxlsx.html">Upgrade from openxlsx</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/JanMarvin/openxlsx2/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Add a pivot table to a worksheet</h1>
      <small class="dont-index">Source: <a href="https://github.com/JanMarvin/openxlsx2/blob/HEAD/R/class-workbook-wrappers.R" class="external-link"><code>R/class-workbook-wrappers.R</code></a></small>
      <div class="d-none name"><code>wb_add_pivot_table.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The data must be specified using <code><a href="wb_data.html">wb_data()</a></code> to ensure the function works.
The sheet will be empty unless it is opened in spreadsheet software. Find
more details in the <a href="https://janmarvin.github.io/ox2-book/chapters/openxlsx2_pivot_tables.html" class="external-link">section about pivot tables</a>
in the openxlsx2 book.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wb_add_pivot_table</span><span class="op">(</span></span>
<span>  <span class="va">wb</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  sheet <span class="op">=</span> <span class="fu"><a href="waivers.html">next_sheet</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dims <span class="op">=</span> <span class="st">"A3"</span>,</span>
<span>  <span class="va">filter</span>,</span>
<span>  <span class="va">rows</span>,</span>
<span>  <span class="va">cols</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">fun</span>,</span>
<span>  <span class="va">params</span>,</span>
<span>  <span class="va">pivot_table</span>,</span>
<span>  <span class="va">slicer</span>,</span>
<span>  <span class="va">timeline</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>wb</dt>
<dd><p>A Workbook object containing a #' worksheet.</p></dd>


<dt>x</dt>
<dd><p>A <code>data.frame</code> that inherits the <code><a href="wb_data.html">wb_data</a></code> class.</p></dd>


<dt>sheet</dt>
<dd><p>A worksheet containing a #'</p></dd>


<dt>dims</dt>
<dd><p>The worksheet cell where the pivot table is placed</p></dd>


<dt>filter</dt>
<dd><p>The column name(s) of <code>x</code> used for filter.</p></dd>


<dt>rows</dt>
<dd><p>The column name(s) of <code>x</code> used as rows</p></dd>


<dt>cols</dt>
<dd><p>The column names(s) of <code>x</code> used as cols</p></dd>


<dt>data</dt>
<dd><p>The column name(s) of <code>x</code> used as data</p></dd>


<dt>fun</dt>
<dd><p>A vector of functions to be used with <code>data</code>. See <strong>Details</strong> for the list of available options.</p></dd>


<dt>params</dt>
<dd><p>A list of parameters to modify pivot table creation. See <strong>Details</strong> for available options.</p></dd>


<dt>pivot_table</dt>
<dd><p>An optional name for the pivot table</p></dd>


<dt>slicer, timeline</dt>
<dd><p>Any additional column name(s) of <code>x</code> used as slicer/timeline</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The pivot table is not actually written to the worksheet, therefore the cell
region has to remain empty. What is written to the workbook is something
like a recipe how the spreadsheet software has to construct the pivot table
when opening the file.</p>
<p>It is possible to add slicers to the pivot table. For this the pivot
table has to be named and the variable used as slicer, must be part
of the selected pivot table names (<code>cols</code>, <code>rows</code>, <code>filter</code>, or
<code>slicer</code>). If these criteria are matched, a slicer can be added
using <code><a href="wb_add_slicer.html">wb_add_slicer()</a></code>.</p>
<p>Be aware that you should always test on a copy if a <code>param</code> argument works
with a pivot table. Not only to check if the desired effect appears, but
first and foremost if the file loads. Wildly mixing params might brick the
output file and cause spreadsheet software to crash.</p>
<p><code>fun</code> can be any of <code>AVERAGE</code>, <code>COUNT</code>, <code>COUNTA</code>, <code>MAX</code>, <code>MIN</code>,
<code>PRODUCT</code>, <code>STDEV</code>, <code>STDEVP</code>, <code>SUM</code>, <code>VAR</code>, <code>VARP</code>.</p>
<p><code>show_data_as</code> can be any of <code>normal</code>, <code>difference</code>, <code>percent</code>, <code>percentDiff</code>,
<code>runTotal</code>, <code>percentOfRow</code>, <code>percentOfCol</code>, <code>percentOfTotal</code>, <code>index</code>.</p>
<p>It is possible to calculate data fields if the formula is assigned as a
variable name for the field to calculate. This would look like this:
<code>data = c("am", "disp/cyl" = "New")</code></p>
<p>Possible <code>params</code> arguments are listed below. Pivot tables accepts more
parameters, but they were either not tested or misbehaved (probably because
we misunderstood how the parameter should be used).</p>
<p>Boolean arguments:</p><ul><li><p>apply_alignment_formats</p></li>
<li><p>apply_number_formats</p></li>
<li><p>apply_border_formats</p></li>
<li><p>apply_font_formats</p></li>
<li><p>apply_pattern_formats</p></li>
<li><p>apply_width_height_formats</p></li>
<li><p>no_style</p></li>
<li><p>compact</p></li>
<li><p>outline</p></li>
<li><p>compact_data</p></li>
<li><p>row_grand_totals</p></li>
<li><p>col_grand_totals</p></li>
</ul><p>Table styles accepting character strings:</p><ul><li><p>auto_format_id: style id as character in the range of 4096 to 4117</p></li>
<li><p>table_style: a predefined (pivot) table style <code>"TableStyleMedium23"</code></p></li>
<li><p>show_data_as: accepts character strings as listed above</p></li>
</ul><p>Miscellaneous:</p><ul><li><p>numfmt: accepts vectors of the form <code>c(formatCode = "0.0%")</code></p></li>
<li><p>choose: select variables in the form of a named logical vector like
<code>c(agegp = 'x &gt; "25-34"')</code> for the <code>esoph</code> dataset.</p></li>
<li><p>sort_item: named list of index or character vectors</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="wb_data.html">wb_data()</a></code></p>
<p>Other workbook wrappers: 
<code><a href="base_font-wb.html">base_font-wb</a></code>,
<code><a href="col_widths-wb.html">col_widths-wb</a></code>,
<code><a href="creators-wb.html">creators-wb</a></code>,
<code><a href="grouping-wb.html">grouping-wb</a></code>,
<code><a href="row_heights-wb.html">row_heights-wb</a></code>,
<code><a href="wb_add_chartsheet.html">wb_add_chartsheet</a>()</code>,
<code><a href="wb_add_data.html">wb_add_data</a>()</code>,
<code><a href="wb_add_data_table.html">wb_add_data_table</a>()</code>,
<code><a href="wb_add_formula.html">wb_add_formula</a>()</code>,
<code><a href="wb_add_slicer.html">wb_add_slicer</a>()</code>,
<code><a href="wb_add_worksheet.html">wb_add_worksheet</a>()</code>,
<code><a href="wb_base_colors.html">wb_base_colors</a></code>,
<code><a href="wb_clone_worksheet.html">wb_clone_worksheet</a>()</code>,
<code><a href="wb_copy_cells.html">wb_copy_cells</a>()</code>,
<code><a href="wb_freeze_pane.html">wb_freeze_pane</a>()</code>,
<code><a href="wb_merge_cells.html">wb_merge_cells</a>()</code>,
<code><a href="wb_save.html">wb_save</a>()</code>,
<code><a href="wb_set_last_modified_by.html">wb_set_last_modified_by</a>()</code>,
<code><a href="wb_workbook.html">wb_workbook</a>()</code></p>
<p>Other worksheet content functions: 
<code><a href="col_widths-wb.html">col_widths-wb</a></code>,
<code><a href="filter-wb.html">filter-wb</a></code>,
<code><a href="grouping-wb.html">grouping-wb</a></code>,
<code><a href="named_region-wb.html">named_region-wb</a></code>,
<code><a href="row_heights-wb.html">row_heights-wb</a></code>,
<code><a href="wb_add_conditional_formatting.html">wb_add_conditional_formatting</a>()</code>,
<code><a href="wb_add_data.html">wb_add_data</a>()</code>,
<code><a href="wb_add_data_table.html">wb_add_data_table</a>()</code>,
<code><a href="wb_add_formula.html">wb_add_formula</a>()</code>,
<code><a href="wb_add_slicer.html">wb_add_slicer</a>()</code>,
<code><a href="wb_add_thread.html">wb_add_thread</a>()</code>,
<code><a href="wb_freeze_pane.html">wb_freeze_pane</a>()</code>,
<code><a href="wb_merge_cells.html">wb_merge_cells</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="fu"><a href="wb_workbook.html">wb_workbook</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="wb_add_worksheet.html">wb_add_worksheet</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="fu"><a href="wb_add_data.html">wb_add_data</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mtcars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="wb_data.html">wb_data</a></span><span class="op">(</span><span class="va">wb</span>, sheet <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">wb</span> <span class="op">&lt;-</span> <span class="va">wb</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># default pivot table</span></span></span>
<span class="r-in"><span>  <span class="fu">wb_add_pivot_table</span><span class="op">(</span><span class="va">df</span>, dims <span class="op">=</span> <span class="st">"A3"</span>,</span></span>
<span class="r-in"><span>    filter <span class="op">=</span> <span class="st">"am"</span>, rows <span class="op">=</span> <span class="st">"cyl"</span>, cols <span class="op">=</span> <span class="st">"gear"</span>, data <span class="op">=</span> <span class="st">"disp"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># with parameters</span></span></span>
<span class="r-in"><span>  <span class="fu">wb_add_pivot_table</span><span class="op">(</span><span class="va">df</span>,</span></span>
<span class="r-in"><span>    filter <span class="op">=</span> <span class="st">"am"</span>, rows <span class="op">=</span> <span class="st">"cyl"</span>, cols <span class="op">=</span> <span class="st">"gear"</span>, data <span class="op">=</span> <span class="st">"disp"</span>,</span></span>
<span class="r-in"><span>    params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>no_style <span class="op">=</span> <span class="cn">TRUE</span>, numfmt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>formatCode <span class="op">=</span> <span class="st">"##0.0"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jordan Mark Barbone, Jan Marvin Garbuszus.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

