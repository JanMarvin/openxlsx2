# Register a style in a workbook

The `wb_add_style()` function serves as a general-purpose entry point
for registering XML-based style definitions into a `wbWorkbook`. While
specific wrappers like
[`wb_add_font()`](https://janmarvin.github.io/openxlsx2/reference/wb_add_font.md)
target individual cell properties, `wb_add_style()` is used to add
pre-constructed styles—such as custom table styles or differential
formatting (DXF) styles—to the workbook's internal style manager.

## Usage

``` r
wb_add_style(wb, style = NULL, style_name = NULL)
```

## Arguments

- wb:

  A
  [wbWorkbook](https://janmarvin.github.io/openxlsx2/reference/wbWorkbook.md)
  object.

- style:

  A character string containing the XML definition of the style. This is
  usually the output of functions like
  [`create_cell_style()`](https://janmarvin.github.io/openxlsx2/reference/create_cell_style.md)
  or
  [`create_dxfs_style()`](https://janmarvin.github.io/openxlsx2/reference/create_dxfs_style.md).

- style_name:

  Optional; a unique name for the style. If `NULL`, the function
  attempts to derive a name from the object name or the internal XML
  attributes (e.g., for table styles).

## Value

The
[wbWorkbook](https://janmarvin.github.io/openxlsx2/reference/wbWorkbook.md)
object, invisibly.

## Details

Styles in the OpenXML specification are stored in a centralized catalog
(`styles.xml`). This function takes an XML character string, typically
generated by a `create_*()` function, and registers it under a specific
`style_name`.

Once registered, these styles can be applied to cells, ranges, or tables
by referencing their name. This is particularly useful for maintaining
consistency across a large workbook or when creating complex "Table
Styles" that define headers, footers, and banding in a single object.

## Notes

- If the `style` provided is a `tableStyle` node, the function
  automatically extracts the name from the XML attribute if `style_name`
  is not provided.

- Registering a style does not automatically apply it to a cell; it only
  makes the style available within the workbook's style catalog.

## See also

- [`create_border()`](https://janmarvin.github.io/openxlsx2/reference/create_border.md)

- [`create_cell_style()`](https://janmarvin.github.io/openxlsx2/reference/create_cell_style.md)

- [`create_dxfs_style()`](https://janmarvin.github.io/openxlsx2/reference/create_dxfs_style.md)

- [`create_fill()`](https://janmarvin.github.io/openxlsx2/reference/create_fill.md)

- [`create_font()`](https://janmarvin.github.io/openxlsx2/reference/create_font.md)

- [`create_numfmt()`](https://janmarvin.github.io/openxlsx2/reference/create_numfmt.md)

Other workbook styling functions:
[`base_font-wb`](https://janmarvin.github.io/openxlsx2/reference/base_font-wb.md),
[`wb_add_dxfs_style()`](https://janmarvin.github.io/openxlsx2/reference/wb_add_dxfs_style.md),
[`wb_base_colors`](https://janmarvin.github.io/openxlsx2/reference/wb_base_colors.md)

## Examples

``` r
yellow_f <- wb_color(hex = "FF9C6500")
yellow_b <- wb_color(hex = "FFFFEB9C")

yellow <- create_dxfs_style(font_color = yellow_f, bg_fill = yellow_b)
wb <- wb_workbook()
wb <- wb_add_style(wb, yellow)
```
